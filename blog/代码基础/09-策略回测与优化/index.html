<!doctype html><html lang=zh-cn class=h-full><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-XXXXXXX")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XXXXXXXXXX")</script><title>代码基础第9讲：策略回测与优化 | 烧烤量化</title>
<meta name=description content="深入学习量化策略回测与优化技术，包括回测系统设计、参数优化方法、过拟合检测、性能评估指标等核心内容，为实盘交易做好充分准备。"><meta name=author content="Ryan"><meta name=robots content="index, follow"><meta property="og:title" content="代码基础第9讲：策略回测与优化 | 烧烤量化"><meta property="og:description" content="深入学习量化策略回测与优化技术，包括回测系统设计、参数优化方法、过拟合检测、性能评估指标等核心内容，为实盘交易做好充分准备。"><meta property="og:type" content="article"><meta property="og:url" content="https://sk-quant.github.io/blog/%E4%BB%A3%E7%A0%81%E5%9F%BA%E7%A1%80/09-%E7%AD%96%E7%95%A5%E5%9B%9E%E6%B5%8B%E4%B8%8E%E4%BC%98%E5%8C%96/"><meta property="og:site_name" content="烧烤量化"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="代码基础第9讲：策略回测与优化 | 烧烤量化"><meta name=twitter:description content="深入学习量化策略回测与优化技术，包括回测系统设计、参数优化方法、过拟合检测、性能评估指标等核心内容，为实盘交易做好充分准备。"><link rel=icon type=image/x-icon href=/images/favicon.ico><link rel=canonical href=https://sk-quant.github.io/blog/%E4%BB%A3%E7%A0%81%E5%9F%BA%E7%A1%80/09-%E7%AD%96%E7%95%A5%E5%9B%9E%E6%B5%8B%E4%B8%8E%E4%BC%98%E5%8C%96/><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel=stylesheet><link rel=stylesheet href="/css/main.min.1255c60f0805e580d846a005c9da456febfe5426dbcd39f66ba0ae2958126a2d.css"></head><body class="min-h-screen flex flex-col"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div class="fixed top-0 left-0 right-0 z-50"><div class=mobile-menu-wrapper><input type=checkbox id=nav-toggle class=nav-toggle><header class="fixed w-full top-0 z-50 bg-white/80 backdrop-blur-sm border-b border-gray-100"><div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl"><nav class="flex items-center justify-between h-20"><a href=https://sk-quant.github.io/ class="flex items-center space-x-4"><img src=/images/logo.svg alt=烧烤量化 class=h-12>
<span class="text-3xl font-semibold text-gray-800">烧烤量化</span></a><div class="hidden md:flex items-center space-x-8"><a href=/path class="text-base text-gray-900 hover:text-primary-600 font-bold transition duration-200">学习路线</a><div class="relative group"><button class="flex items-center text-base text-gray-900 hover:text-primary-600 font-bold transition duration-200">
量化基础<svg class="ml-2 w-4 h-4" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg></button><div class="absolute left-0 mt-2 w-72 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 ease-in-out"><div class="py-6 bg-white border border-gray-100 shadow-xl rounded-lg"><a href=/categories/%e6%8a%95%e8%b5%84%e7%90%86%e8%ae%ba/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">投资理论</a>
<a href=/categories/%e4%bb%a3%e7%a0%81%e5%9f%ba%e7%a1%80/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">代码基础</a>
<a href=/categories/%e6%8a%80%e6%9c%af%e6%8c%87%e6%a0%87/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">技术指标</a>
<a href=/categories/%e5%9b%9e%e6%b5%8b%e5%b9%b3%e5%8f%b0/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">回测平台</a></div></div></div><div class="relative group"><button class="flex items-center text-base text-gray-900 hover:text-primary-600 font-bold transition duration-200">
量化进阶<svg class="ml-2 w-4 h-4" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg></button><div class="absolute left-0 mt-2 w-72 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 ease-in-out"><div class="py-6 bg-white border border-gray-100 shadow-xl rounded-lg"><a href=/categories/%e7%ad%96%e7%95%a5%e5%88%86%e4%ba%ab/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">策略分享</a>
<a href=/categories/%e5%ae%9e%e7%9b%98%e5%b7%a5%e5%85%b7/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">实盘工具</a>
<a href=/categories/%e7%83%ad%e7%82%b9%e9%a3%8e%e5%8f%a3/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">热点风口</a>
<a href=/categories/%e7%bb%bc%e5%90%88%e5%ae%9e%e6%88%98/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">综合实战</a></div></div></div><div class="relative group"><button class="flex items-center text-base text-gray-900 hover:text-primary-600 font-bold transition duration-200">
量化高手<svg class="ml-2 w-4 h-4" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg></button><div class="absolute left-0 mt-2 w-72 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 ease-in-out"><div class="py-6 bg-white border border-gray-100 shadow-xl rounded-lg"><a href=/categories/%e5%8f%af%e8%bd%ac%e5%80%ba/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">可转债</a>
<a href=/categories/%e8%9e%8d%e8%b5%84%e8%9e%8d%e5%88%b8/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">融资融券</a>
<a href=/categories/%e8%82%a1%e7%a5%a8%e6%9c%9f%e6%9d%83/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">股票期权</a>
<a href=/categories/%e8%82%a1%e6%8c%87%e6%9c%9f%e8%b4%a7/ class="block px-8 py-3 text-sm text-gray-700 hover:bg-gray-50">股指期货</a></div></div></div><a href=/pricing class="text-base text-gray-900 hover:text-primary-600 font-bold transition duration-200">服务套餐</a></div><div class="hidden md:flex items-center space-x-4"><a href=/contact class="inline-flex items-center justify-center px-6 py-3 rounded-lg font-bold transition duration-200 ease-in-out bg-primary-600 text-white hover:bg-primary-700 hover:scale-105">现在加入</a></div><div class=md:hidden><label for=nav-toggle class="p-2 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-600 focus:ring-offset-2 transition-colors cursor-pointer"><svg class="w-6 h-6" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></label></div></nav></div><div class="nav-content md:hidden w-full fixed left-0 right-0 top-20 bg-white border-t border-gray-100 shadow-lg"><div class="w-full px-6 py-4"><a href=/path class="block text-xl text-gray-900 hover:text-primary-600 font-bold transition duration-200 py-2">学习路线</a><div class=py-2><div class="text-xl text-gray-900 font-bold mb-2">量化基础</div><div class=pl-4><a href=/categories/%e6%8a%95%e8%b5%84%e7%90%86%e8%ae%ba/ class="block text-gray-700 hover:text-primary-600 py-2">投资理论</a>
<a href=/categories/%e4%bb%a3%e7%a0%81%e5%9f%ba%e7%a1%80/ class="block text-gray-700 hover:text-primary-600 py-2">代码基础</a>
<a href=/categories/%e6%8a%80%e6%9c%af%e6%8c%87%e6%a0%87/ class="block text-gray-700 hover:text-primary-600 py-2">技术指标</a>
<a href=/categories/%e5%9b%9e%e6%b5%8b%e5%b9%b3%e5%8f%b0/ class="block text-gray-700 hover:text-primary-600 py-2">回测平台</a></div></div><div class=py-2><div class="text-xl text-gray-900 font-bold mb-2">量化进阶</div><div class=pl-4><a href=/categories/%e7%ad%96%e7%95%a5%e5%88%86%e4%ba%ab/ class="block text-gray-700 hover:text-primary-600 py-2">策略分享</a>
<a href=/categories/%e5%ae%9e%e7%9b%98%e5%b7%a5%e5%85%b7/ class="block text-gray-700 hover:text-primary-600 py-2">实盘工具</a>
<a href=/categories/%e7%83%ad%e7%82%b9%e9%a3%8e%e5%8f%a3/ class="block text-gray-700 hover:text-primary-600 py-2">热点风口</a>
<a href=/categories/%e7%bb%bc%e5%90%88%e5%ae%9e%e6%88%98/ class="block text-gray-700 hover:text-primary-600 py-2">综合实战</a></div></div><div class=py-2><div class="text-xl text-gray-900 font-bold mb-2">量化高手</div><div class=pl-4><a href=/categories/%e5%8f%af%e8%bd%ac%e5%80%ba/ class="block text-gray-700 hover:text-primary-600 py-2">可转债</a>
<a href=/categories/%e8%9e%8d%e8%b5%84%e8%9e%8d%e5%88%b8/ class="block text-gray-700 hover:text-primary-600 py-2">融资融券</a>
<a href=/categories/%e8%82%a1%e7%a5%a8%e6%9c%9f%e6%9d%83/ class="block text-gray-700 hover:text-primary-600 py-2">股票期权</a>
<a href=/categories/%e8%82%a1%e6%8c%87%e6%9c%9f%e8%b4%a7/ class="block text-gray-700 hover:text-primary-600 py-2">股指期货</a></div></div><a href=/pricing class="block text-xl text-gray-900 hover:text-primary-600 font-bold transition duration-200 py-2">服务套餐</a><div class="pt-4 space-y-4"><a href=/contact class="block text-center px-6 py-3 rounded-lg font-bold transition duration-200 ease-in-out bg-primary-600 text-white hover:bg-primary-700 hover:scale-105">现在加入</a></div></div></div></header><style>.mobile-menu-wrapper{position:relative}.nav-toggle{display:none}.nav-content{display:none}.nav-toggle:checked~header .nav-content{display:block}</style></div></div><div class=pt-20><div class="container mx-auto px-4 py-12"><div class="flex flex-col lg:flex-row gap-8 mb-12"><article class=flex-1><header class=mb-8><div class=mb-4><a href=/categories/%E4%BB%A3%E7%A0%81%E5%9F%BA%E7%A1%80 class="inline-block px-3 py-1 text-sm font-medium text-primary-600 bg-primary-50 rounded-full hover:bg-primary-100 mr-2">代码基础</a></div><h1 class="text-4xl font-bold mb-4">代码基础第9讲：策略回测与优化</h1><div class="flex flex-col space-y-4"><div class="flex items-center justify-between text-sm text-gray-500"><div class="flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7A4 4 0 118 7a4 4 0 018 0zm-4 7a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
<span>Ryan</span></div><div class="flex items-center space-x-6"><div class="flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747.0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746.0-3.332.477-4.5 1.253"/></svg>
<span>35 分钟</span></div><div class="flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v12a2 2 0 002 2z"/></svg>
<time datetime=2025-09-09>September 9, 2025</time></div></div></div><div class="flex items-center flex-wrap gap-2"><a href=/tags/2025 class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-sm text-gray-700 transition-colors duration-200">#2025</a></div></div></header><div class=mb-8><img src=/images/blog/%e4%bb%a3%e7%a0%81%e5%9f%ba%e7%a1%80.jpg alt=代码基础第9讲：策略回测与优化 class="w-full h-auto rounded-lg" loading=lazy></div><div class="prose prose-lg max-w-none"><h2 id=学习目标>学习目标</h2><p>通过本讲的学习，你将掌握：</p><ul><li>回测系统的架构设计与实现</li><li>参数优化方法与算法</li><li>过拟合检测与防范技术</li><li>策略性能评估与指标分析</li><li>交易成本建模与滑点处理</li><li>多策略组合与风险管理</li><li>回测结果可视化与报告生成</li><li>实盘前的准备工作</li></ul><h2 id=目录>目录</h2><ol><li><a href=#%E5%9B%9E%E6%B5%8B%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1>回测系统架构设计</a></li><li><a href=#%E5%9B%9E%E6%B5%8B%E5%BC%95%E6%93%8E%E5%AE%9E%E7%8E%B0>回测引擎实现</a></li><li><a href=#%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95>参数优化方法</a></li><li><a href=#%E8%BF%87%E6%8B%9F%E5%90%88%E6%A3%80%E6%B5%8B%E4%B8%8E%E9%98%B2%E8%8C%83>过拟合检测与防范</a></li><li><a href=#%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87>性能评估指标</a></li><li><a href=#%E4%BA%A4%E6%98%93%E6%88%90%E6%9C%AC%E5%BB%BA%E6%A8%A1>交易成本建模</a></li><li><a href=#%E5%A4%9A%E7%AD%96%E7%95%A5%E7%BB%84%E5%90%88>多策略组合</a></li><li><a href=#%E5%9B%9E%E6%B5%8B%E7%BB%93%E6%9E%9C%E5%8F%AF%E8%A7%86%E5%8C%96>回测结果可视化</a></li><li><a href=#%E5%AE%9E%E7%9B%98%E5%89%8D%E5%87%86%E5%A4%87>实盘前准备</a></li><li><a href=#%E5%AE%9E%E8%B7%B5%E7%BB%83%E4%B9%A0>实践练习</a></li><li><a href=#%E6%80%BB%E7%BB%93%E4%B8%8E%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB>总结与扩展阅读</a></li></ol><h2 id=回测系统架构设计>回测系统架构设计</h2><h3 id=回测系统核心组件>回测系统核心组件</h3><div class="not-prose my-8 overflow-hidden rounded-lg bg-gray-900 shadow-lg"><div class="p-4 overflow-x-auto"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BacktestConfig</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;回测配置&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>start_date</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>end_date</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>initial_capital</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>commission_rate</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.001</span>
</span></span><span class=line><span class=cl>    <span class=n>slippage_rate</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0005</span>
</span></span><span class=line><span class=cl>    <span class=n>min_commission</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>5.0</span>
</span></span><span class=line><span class=cl>    <span class=n>max_position_size</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.1</span>
</span></span><span class=line><span class=cl>    <span class=n>max_portfolio_risk</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.02</span>
</span></span><span class=line><span class=cl>    <span class=n>risk_free_rate</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.03</span>
</span></span><span class=line><span class=cl>    <span class=n>benchmark</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;SH000300&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>rebalance_frequency</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;daily&#34;</span>  <span class=c1># daily, weekly, monthly</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TradeRecord</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;交易记录&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>symbol</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>action</span><span class=p>:</span> <span class=nb>str</span>  <span class=c1># BUY, SELL</span>
</span></span><span class=line><span class=cl>    <span class=n>quantity</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>commission</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>slippage</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>total_cost</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>portfolio_value</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>position_size</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PortfolioSnapshot</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;组合快照&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>total_value</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>cash</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>positions</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>weights</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>returns</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>cumulative_returns</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>drawdown</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>volatility</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BacktestEngine</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;回测引擎基类&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>BacktestConfig</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>initialize_portfolio</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>signals_history</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>performance_metrics</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>is_running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>initialize_portfolio</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;初始化组合&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;cash&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>initial_capital</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;positions&#39;</span><span class=p>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_value&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>initial_capital</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;weights&#39;</span><span class=p>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_signals</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;生成交易信号&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_position_size</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>signal</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>current_price</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算仓位大小&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run_backtest</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                    <span class=n>strategy_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;运行回测&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;开始回测: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>start_date</span><span class=si>}</span><span class=s2> 到 </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>end_date</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>is_running</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 获取交易日历</span>
</span></span><span class=line><span class=cl>        <span class=n>trading_dates</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_trading_dates</span><span class=p>(</span><span class=n>market_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>current_date</span> <span class=ow>in</span> <span class=n>trading_dates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_running</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=c1># 获取当日数据</span>
</span></span><span class=line><span class=cl>            <span class=n>daily_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_daily_data</span><span class=p>(</span><span class=n>market_data</span><span class=p>,</span> <span class=n>current_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>daily_data</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 生成交易信号</span>
</span></span><span class=line><span class=cl>            <span class=n>signals</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_signals</span><span class=p>(</span><span class=n>daily_data</span><span class=p>,</span> <span class=n>current_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>signals_history</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>current_date</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;signals&#39;</span><span class=p>:</span> <span class=n>signals</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 执行交易</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>signal</span> <span class=ow>in</span> <span class=n>signals</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>execute_trade</span><span class=p>(</span><span class=n>signal</span><span class=p>,</span> <span class=n>daily_data</span><span class=p>,</span> <span class=n>current_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 更新组合价值</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>update_portfolio_value</span><span class=p>(</span><span class=n>daily_data</span><span class=p>,</span> <span class=n>current_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 记录组合状态</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>record_portfolio_snapshot</span><span class=p>(</span><span class=n>current_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算性能指标</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>calculate_performance_metrics</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_backtest_report</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_trading_dates</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>datetime</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;获取交易日历&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 使用第一个股票的数据日期作为交易日历</span>
</span></span><span class=line><span class=cl>        <span class=n>symbol</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>market_data</span><span class=o>.</span><span class=n>keys</span><span class=p>())[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>market_data</span><span class=p>[</span><span class=n>symbol</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 过滤日期范围</span>
</span></span><span class=line><span class=cl>        <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>start_date</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>end_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>trading_dates</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=n>mask</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>trading_dates</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_daily_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                      <span class=n>date</span><span class=p>:</span> <span class=n>datetime</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;获取当日市场数据&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>daily_data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>symbol</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>market_data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>date</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>daily_data</span><span class=p>[</span><span class=n>symbol</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>date</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>daily_data</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute_trade</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>signal</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                     <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;执行交易&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>symbol</span> <span class=o>=</span> <span class=n>signal</span><span class=p>[</span><span class=s1>&#39;symbol&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>action</span> <span class=o>=</span> <span class=n>signal</span><span class=p>[</span><span class=s1>&#39;action&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>quantity</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;quantity&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>symbol</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>market_data</span><span class=o>.</span><span class=n>index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 获取当前价格</span>
</span></span><span class=line><span class=cl>        <span class=n>current_data</span> <span class=o>=</span> <span class=n>market_data</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>symbol</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_price</span> <span class=o>=</span> <span class=n>current_data</span><span class=p>[</span><span class=s1>&#39;close&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算交易成本和滑点</span>
</span></span><span class=line><span class=cl>        <span class=n>commission</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>min_commission</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                        <span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>commission_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>slippage</span> <span class=o>=</span> <span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>slippage_rate</span>
</span></span><span class=line><span class=cl>        <span class=n>total_cost</span> <span class=o>=</span> <span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>+</span> <span class=n>commission</span> <span class=o>+</span> <span class=n>slippage</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 执行买入</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>action</span> <span class=o>==</span> <span class=s1>&#39;BUY&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>total_cost</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 更新现金</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span> <span class=o>-=</span> <span class=n>total_cost</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 更新持仓</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>+=</span> <span class=n>quantity</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>=</span> <span class=n>quantity</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 记录交易</span>
</span></span><span class=line><span class=cl>                <span class=n>trade</span> <span class=o>=</span> <span class=n>TradeRecord</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>timestamp</span><span class=o>=</span><span class=n>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>symbol</span><span class=o>=</span><span class=n>symbol</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>action</span><span class=o>=</span><span class=s1>&#39;BUY&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>quantity</span><span class=o>=</span><span class=n>quantity</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>price</span><span class=o>=</span><span class=n>current_price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>commission</span><span class=o>=</span><span class=n>commission</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>slippage</span><span class=o>=</span><span class=n>slippage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>total_cost</span><span class=o>=</span><span class=n>total_cost</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>portfolio_value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=n>position_size</span><span class=o>=</span><span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>trade</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;买入: </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>quantity</span><span class=si>}</span><span class=s2>股 @ </span><span class=si>{</span><span class=n>current_price</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, 成本: </span><span class=si>{</span><span class=n>total_cost</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 执行卖出</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>action</span> <span class=o>==</span> <span class=s1>&#39;SELL&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>quantity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 更新现金</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=p>(</span><span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>-</span> <span class=n>commission</span> <span class=o>-</span> <span class=n>slippage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 更新持仓</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>-=</span> <span class=n>quantity</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 记录交易</span>
</span></span><span class=line><span class=cl>                <span class=n>trade</span> <span class=o>=</span> <span class=n>TradeRecord</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>timestamp</span><span class=o>=</span><span class=n>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>symbol</span><span class=o>=</span><span class=n>symbol</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>action</span><span class=o>=</span><span class=s1>&#39;SELL&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>quantity</span><span class=o>=</span><span class=n>quantity</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>price</span><span class=o>=</span><span class=n>current_price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>commission</span><span class=o>=</span><span class=n>commission</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>slippage</span><span class=o>=</span><span class=n>slippage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>total_cost</span><span class=o>=</span><span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>-</span> <span class=n>commission</span> <span class=o>-</span> <span class=n>slippage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>portfolio_value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=n>position_size</span><span class=o>=</span><span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>trade</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;卖出: </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>quantity</span><span class=si>}</span><span class=s2>股 @ </span><span class=si>{</span><span class=n>current_price</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, 收入: </span><span class=si>{</span><span class=n>total_cost</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update_portfolio_value</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;更新组合价值&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>total_value</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>symbol</span><span class=p>,</span> <span class=n>position</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=n>market_data</span><span class=o>.</span><span class=n>index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>current_price</span> <span class=o>=</span> <span class=n>market_data</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>symbol</span><span class=p>,</span> <span class=s1>&#39;close&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>total_value</span> <span class=o>+=</span> <span class=n>position</span> <span class=o>*</span> <span class=n>current_price</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>total_value</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 更新权重</span>
</span></span><span class=line><span class=cl>        <span class=n>weights</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>symbol</span><span class=p>,</span> <span class=n>position</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=n>market_data</span><span class=o>.</span><span class=n>index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>current_price</span> <span class=o>=</span> <span class=n>market_data</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>symbol</span><span class=p>,</span> <span class=s1>&#39;close&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>position_value</span> <span class=o>=</span> <span class=n>position</span> <span class=o>*</span> <span class=n>current_price</span>
</span></span><span class=line><span class=cl>                <span class=n>weights</span><span class=p>[</span><span class=n>symbol</span><span class=p>]</span> <span class=o>=</span> <span class=n>position_value</span> <span class=o>/</span> <span class=n>total_value</span> <span class=k>if</span> <span class=n>total_value</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;weights&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>weights</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>record_portfolio_snapshot</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;记录组合快照&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>snapshot</span> <span class=o>=</span> <span class=n>PortfolioSnapshot</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>timestamp</span><span class=o>=</span><span class=n>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>total_value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>cash</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>positions</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>weights</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;weights&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>returns</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>cumulative_returns</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>drawdown</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>volatility</span><span class=o>=</span><span class=mf>0.0</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>snapshot</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_performance_metrics</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算性能指标&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 转换为DataFrame</span>
</span></span><span class=line><span class=cl>        <span class=n>portfolio_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>s</span><span class=o>.</span><span class=n>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;total_value&#39;</span><span class=p>:</span> <span class=n>s</span><span class=o>.</span><span class=n>total_value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;cash&#39;</span><span class=p>:</span> <span class=n>s</span><span class=o>.</span><span class=n>cash</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算收益率</span>
</span></span><span class=line><span class=cl>        <span class=n>portfolio_df</span><span class=p>[</span><span class=s1>&#39;returns&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>portfolio_df</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>portfolio_df</span><span class=p>[</span><span class=s1>&#39;cumulative_returns&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>portfolio_df</span><span class=p>[</span><span class=s1>&#39;returns&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span><span class=o>.</span><span class=n>cumprod</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 更新快照</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>snapshot</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>snapshot</span><span class=o>.</span><span class=n>returns</span> <span class=o>=</span> <span class=n>portfolio_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=s1>&#39;returns&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>snapshot</span><span class=o>.</span><span class=n>cumulative_returns</span> <span class=o>=</span> <span class=n>portfolio_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=s1>&#39;cumulative_returns&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算详细指标</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>performance_metrics</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_detailed_metrics</span><span class=p>(</span><span class=n>portfolio_df</span><span class=p>[</span><span class=s1>&#39;returns&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_detailed_metrics</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>returns</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算详细性能指标&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 基本指标</span>
</span></span><span class=line><span class=cl>        <span class=n>total_return</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>total_value</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>initial_capital</span><span class=p>)</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>initial_capital</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;total_return&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>total_return</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 年化收益率</span>
</span></span><span class=line><span class=cl>        <span class=n>days</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>returns</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_return&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>total_return</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=mi>252</span> <span class=o>/</span> <span class=n>days</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>days</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 年化波动率</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_volatility&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>returns</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>252</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 夏普比率</span>
</span></span><span class=line><span class=cl>        <span class=n>excess_returns</span> <span class=o>=</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_return&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>risk_free_rate</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>excess_returns</span> <span class=o>/</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_volatility&#39;</span><span class=p>]</span> <span class=k>if</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_volatility&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 最大回撤</span>
</span></span><span class=line><span class=cl>        <span class=n>cumulative</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>returns</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span><span class=o>.</span><span class=n>cumprod</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>running_max</span> <span class=o>=</span> <span class=n>cumulative</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>drawdown</span> <span class=o>=</span> <span class=p>(</span><span class=n>cumulative</span> <span class=o>-</span> <span class=n>running_max</span><span class=p>)</span> <span class=o>/</span> <span class=n>running_max</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;max_drawdown&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>drawdown</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 卡尔马比率</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;max_drawdown&#39;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;calmar_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_return&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=nb>abs</span><span class=p>(</span><span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;max_drawdown&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;calmar_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 胜率</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>winning_trades</span> <span class=o>=</span> <span class=p>[</span><span class=n>t</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span> <span class=k>if</span> <span class=n>t</span><span class=o>.</span><span class=n>action</span> <span class=o>==</span> <span class=s1>&#39;SELL&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;win_rate&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>winning_trades</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;win_rate&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 交易统计</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;total_trades&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;avg_trade_return&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>([</span><span class=n>t</span><span class=o>.</span><span class=n>total_cost</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=p>])</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>metrics</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_backtest_report</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;生成回测报告&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;config&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;performance_metrics&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>performance_metrics</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;trade_history&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;portfolio_history&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;signals_history&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>signals_history</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;final_portfolio_value&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_return&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>performance_metrics</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;total_return&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>performance_metrics</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;max_drawdown&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>performance_metrics</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;max_drawdown&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div></div><h2 id=回测引擎实现>回测引擎实现</h2><h3 id=高级回测引擎>高级回测引擎</h3><div class="not-prose my-8 overflow-hidden rounded-lg bg-gray-900 shadow-lg"><div class="p-4 overflow-x-auto"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AdvancedBacktestEngine</span><span class=p>(</span><span class=n>BacktestEngine</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;高级回测引擎&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>BacktestConfig</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>risk_model</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>transaction_cost_model</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>slippage_model</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>market_impact_model</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>set_benchmark</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>benchmark_data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;设置基准数据&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span> <span class=o>=</span> <span class=n>benchmark_data</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>set_risk_model</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>risk_model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;设置风险模型&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>risk_model</span> <span class=o>=</span> <span class=n>risk_model</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>set_transaction_cost_model</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cost_model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;设置交易成本模型&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>transaction_cost_model</span> <span class=o>=</span> <span class=n>cost_model</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_transaction_cost</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>symbol</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>quantity</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                 <span class=n>price</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>action</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算交易成本&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>base_cost</span> <span class=o>=</span> <span class=n>quantity</span> <span class=o>*</span> <span class=n>price</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 基本佣金</span>
</span></span><span class=line><span class=cl>        <span class=n>commission</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>min_commission</span><span class=p>,</span> <span class=n>base_cost</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>commission_rate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 使用高级成本模型（如果设置）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>transaction_cost_model</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>additional_costs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>transaction_cost_model</span><span class=o>.</span><span class=n>calculate_cost</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>symbol</span><span class=p>,</span> <span class=n>quantity</span><span class=p>,</span> <span class=n>price</span><span class=p>,</span> <span class=n>action</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>commission</span> <span class=o>+=</span> <span class=n>additional_costs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;additional_commission&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 滑点</span>
</span></span><span class=line><span class=cl>        <span class=n>slippage</span> <span class=o>=</span> <span class=n>base_cost</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>slippage_rate</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 市场冲击（大额交易）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>quantity</span> <span class=o>*</span> <span class=n>price</span> <span class=o>&gt;</span> <span class=mi>100000</span><span class=p>:</span>  <span class=c1># 超过10万元</span>
</span></span><span class=line><span class=cl>            <span class=n>market_impact</span> <span class=o>=</span> <span class=n>base_cost</span> <span class=o>*</span> <span class=mf>0.0005</span>  <span class=c1># 额外0.05%冲击成本</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>market_impact</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;commission&#39;</span><span class=p>:</span> <span class=n>commission</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;slippage&#39;</span><span class=p>:</span> <span class=n>slippage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;market_impact&#39;</span><span class=p>:</span> <span class=n>market_impact</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_cost&#39;</span><span class=p>:</span> <span class=n>commission</span> <span class=o>+</span> <span class=n>slippage</span> <span class=o>+</span> <span class=n>market_impact</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute_trade_with_impact</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>signal</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                                <span class=n>market_data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;执行交易（考虑市场冲击）&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>symbol</span> <span class=o>=</span> <span class=n>signal</span><span class=p>[</span><span class=s1>&#39;symbol&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>action</span> <span class=o>=</span> <span class=n>signal</span><span class=p>[</span><span class=s1>&#39;action&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>quantity</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;quantity&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>symbol</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>market_data</span><span class=o>.</span><span class=n>index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 获取当前价格</span>
</span></span><span class=line><span class=cl>        <span class=n>current_data</span> <span class=o>=</span> <span class=n>market_data</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>symbol</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_price</span> <span class=o>=</span> <span class=n>current_data</span><span class=p>[</span><span class=s1>&#39;close&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算交易成本</span>
</span></span><span class=line><span class=cl>        <span class=n>costs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_transaction_cost</span><span class=p>(</span><span class=n>symbol</span><span class=p>,</span> <span class=n>quantity</span><span class=p>,</span> <span class=n>current_price</span><span class=p>,</span> <span class=n>action</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 大额交易的价格冲击</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>quantity</span> <span class=o>*</span> <span class=n>current_price</span> <span class=o>&gt;</span> <span class=mi>100000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 模拟市场冲击导致的价格滑点</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>action</span> <span class=o>==</span> <span class=s1>&#39;BUY&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>executed_price</span> <span class=o>=</span> <span class=n>current_price</span> <span class=o>*</span> <span class=mf>1.001</span>  <span class=c1># 买入价格上升0.1%</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>executed_price</span> <span class=o>=</span> <span class=n>current_price</span> <span class=o>*</span> <span class=mf>0.999</span>  <span class=c1># 卖出价格下降0.1%</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>executed_price</span> <span class=o>=</span> <span class=n>current_price</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>total_transaction_cost</span> <span class=o>=</span> <span class=n>quantity</span> <span class=o>*</span> <span class=n>executed_price</span> <span class=o>+</span> <span class=n>costs</span><span class=p>[</span><span class=s1>&#39;total_cost&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 执行交易逻辑（与基础引擎类似，但使用实际执行价格）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>action</span> <span class=o>==</span> <span class=s1>&#39;BUY&#39;</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>total_transaction_cost</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span> <span class=o>-=</span> <span class=n>total_transaction_cost</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>symbol</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>quantity</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>action</span> <span class=o>==</span> <span class=s1>&#39;SELL&#39;</span> <span class=ow>and</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>quantity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;cash&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=p>(</span><span class=n>quantity</span> <span class=o>*</span> <span class=n>executed_price</span> <span class=o>-</span> <span class=n>costs</span><span class=p>[</span><span class=s1>&#39;total_cost&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>-=</span> <span class=n>quantity</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;positions&#39;</span><span class=p>][</span><span class=n>symbol</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 记录详细交易信息</span>
</span></span><span class=line><span class=cl>        <span class=n>trade</span> <span class=o>=</span> <span class=n>TradeRecord</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>timestamp</span><span class=o>=</span><span class=n>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>symbol</span><span class=o>=</span><span class=n>symbol</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>action</span><span class=o>=</span><span class=n>action</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>quantity</span><span class=o>=</span><span class=n>quantity</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>price</span><span class=o>=</span><span class=n>executed_price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>commission</span><span class=o>=</span><span class=n>costs</span><span class=p>[</span><span class=s1>&#39;commission&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>slippage</span><span class=o>=</span><span class=n>costs</span><span class=p>[</span><span class=s1>&#39;slippage&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>total_cost</span><span class=o>=</span><span class=n>total_transaction_cost</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>portfolio_value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>position_size</span><span class=o>=</span><span class=n>quantity</span> <span class=o>*</span> <span class=n>executed_price</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio</span><span class=p>[</span><span class=s1>&#39;total_value&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>trade</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_risk_adjusted_metrics</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>returns</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算风险调整指标&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 基础指标</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>calculate_detailed_metrics</span><span class=p>(</span><span class=n>returns</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 索提诺比率（下行风险）</span>
</span></span><span class=line><span class=cl>        <span class=n>downside_returns</span> <span class=o>=</span> <span class=n>returns</span><span class=p>[</span><span class=n>returns</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>downside_returns</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>downside_std</span> <span class=o>=</span> <span class=n>downside_returns</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>252</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>excess_return</span> <span class=o>=</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;annual_return&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>risk_free_rate</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;sortino_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>excess_return</span> <span class=o>/</span> <span class=n>downside_std</span> <span class=k>if</span> <span class=n>downside_std</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;sortino_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 信息比率（相对基准）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>benchmark_returns</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_benchmark_returns</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>active_returns</span> <span class=o>=</span> <span class=n>returns</span> <span class=o>-</span> <span class=n>benchmark_returns</span>
</span></span><span class=line><span class=cl>            <span class=n>tracking_error</span> <span class=o>=</span> <span class=n>active_returns</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>252</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tracking_error</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;information_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>active_returns</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>*</span> <span class=mi>252</span> <span class=o>/</span> <span class=n>tracking_error</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;information_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 收益一致性</span>
</span></span><span class=line><span class=cl>        <span class=n>monthly_returns</span> <span class=o>=</span> <span class=n>returns</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>prod</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;consistency&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>monthly_returns</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 风险价值（VaR）</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;var_95&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>returns</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;var_99&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>returns</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 预期亏损（CVaR）</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;cvar_95&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>returns</span><span class=p>[</span><span class=n>returns</span> <span class=o>&lt;=</span> <span class=n>metrics</span><span class=p>[</span><span class=s1>&#39;var_95&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>metrics</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_benchmark_returns</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算基准收益率&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>dtype</span><span class=o>=</span><span class=nb>float</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 过滤回测期间的数据</span>
</span></span><span class=line><span class=cl>        <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span><span class=o>.</span><span class=n>index</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>start_date</span><span class=p>)</span> <span class=o>&amp;</span> \
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span><span class=o>.</span><span class=n>index</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>end_date</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>benchmark_period</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span><span class=p>[</span><span class=n>mask</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算日收益率</span>
</span></span><span class=line><span class=cl>        <span class=n>benchmark_returns</span> <span class=o>=</span> <span class=n>benchmark_period</span><span class=p>[</span><span class=s1>&#39;close&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>benchmark_returns</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_comprehensive_report</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;生成综合回测报告&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>basic_report</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_backtest_report</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 添加风险调整指标</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>returns</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=n>s</span><span class=o>.</span><span class=n>returns</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>[</span><span class=mi>1</span><span class=p>:]])</span>
</span></span><span class=line><span class=cl>            <span class=n>risk_metrics</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_risk_adjusted_metrics</span><span class=p>(</span><span class=n>returns</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>basic_report</span><span class=p>[</span><span class=s1>&#39;risk_metrics&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>risk_metrics</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 添加基准比较</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>basic_report</span><span class=p>[</span><span class=s1>&#39;benchmark_comparison&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>compare_with_benchmark</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 添加交易分析</span>
</span></span><span class=line><span class=cl>        <span class=n>basic_report</span><span class=p>[</span><span class=s1>&#39;trade_analysis&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>analyze_trades</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>basic_report</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>compare_with_benchmark</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;与基准比较&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>benchmark_data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算策略收益率</span>
</span></span><span class=line><span class=cl>        <span class=n>strategy_returns</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=n>s</span><span class=o>.</span><span class=n>returns</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>[</span><span class=mi>1</span><span class=p>:]])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算基准收益率</span>
</span></span><span class=line><span class=cl>        <span class=n>benchmark_returns</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_benchmark_returns</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 对齐时间序列</span>
</span></span><span class=line><span class=cl>        <span class=n>aligned_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>strategy_returns</span><span class=p>,</span> <span class=n>benchmark_returns</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>strategy_aligned</span> <span class=o>=</span> <span class=n>aligned_data</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>benchmark_aligned</span> <span class=o>=</span> <span class=n>aligned_data</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 计算相对表现</span>
</span></span><span class=line><span class=cl>        <span class=n>comparison</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;strategy_total_return&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>strategy_aligned</span><span class=p>)</span><span class=o>.</span><span class=n>prod</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;benchmark_total_return&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>benchmark_aligned</span><span class=p>)</span><span class=o>.</span><span class=n>prod</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;excess_return&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>strategy_aligned</span><span class=p>)</span><span class=o>.</span><span class=n>prod</span><span class=p>()</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>benchmark_aligned</span><span class=p>)</span><span class=o>.</span><span class=n>prod</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;correlation&#39;</span><span class=p>:</span> <span class=n>strategy_aligned</span><span class=o>.</span><span class=n>corr</span><span class=p>(</span><span class=n>benchmark_aligned</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;beta&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_beta</span><span class=p>(</span><span class=n>strategy_aligned</span><span class=p>,</span> <span class=n>benchmark_aligned</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;alpha&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_alpha</span><span class=p>(</span><span class=n>strategy_aligned</span><span class=p>,</span> <span class=n>benchmark_aligned</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>comparison</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_beta</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>strategy_returns</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=n>benchmark_returns</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算Beta值&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>covariance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cov</span><span class=p>(</span><span class=n>strategy_returns</span><span class=p>,</span> <span class=n>benchmark_returns</span><span class=p>)[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>benchmark_variance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>var</span><span class=p>(</span><span class=n>benchmark_returns</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>covariance</span> <span class=o>/</span> <span class=n>benchmark_variance</span> <span class=k>if</span> <span class=n>benchmark_variance</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_alpha</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>strategy_returns</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=n>benchmark_returns</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;计算Alpha值&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>beta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_beta</span><span class=p>(</span><span class=n>strategy_returns</span><span class=p>,</span> <span class=n>benchmark_returns</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>strategy_return</span> <span class=o>=</span> <span class=n>strategy_returns</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>*</span> <span class=mi>252</span>
</span></span><span class=line><span class=cl>        <span class=n>benchmark_return</span> <span class=o>=</span> <span class=n>benchmark_returns</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>*</span> <span class=mi>252</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>strategy_return</span> <span class=o>-</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>risk_free_rate</span> <span class=o>+</span> <span class=n>beta</span> <span class=o>*</span> <span class=p>(</span><span class=n>benchmark_return</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>risk_free_rate</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>analyze_trades</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;分析交易记录&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>trades_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;symbol&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>symbol</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>action</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>quantity</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;total_cost&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>total_cost</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;commission&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>commission</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;position_size&#39;</span><span class=p>:</span> <span class=n>t</span><span class=o>.</span><span class=n>position_size</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>trade_history</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>analysis</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_trades&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>trades_df</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;buy_trades&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>trades_df</span><span class=p>[</span><span class=n>trades_df</span><span class=p>[</span><span class=s1>&#39;action&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;BUY&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;sell_trades&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>trades_df</span><span class=p>[</span><span class=n>trades_df</span><span class=p>[</span><span class=s1>&#39;action&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;SELL&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_commission&#39;</span><span class=p>:</span> <span class=n>trades_df</span><span class=p>[</span><span class=s1>&#39;commission&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;avg_position_size&#39;</span><span class=p>:</span> <span class=n>trades_df</span><span class=p>[</span><span class=s1>&#39;position_size&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;max_position_size&#39;</span><span class=p>:</span> <span class=n>trades_df</span><span class=p>[</span><span class=s1>&#39;position_size&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;trading_frequency&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>trades_df</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span><span class=p>)</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>portfolio_history</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 按股票分析</span>
</span></span><span class=line><span class=cl>        <span class=n>symbol_analysis</span> <span class=o>=</span> <span class=n>trades_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;symbol&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_cost&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;commission&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;position_size&#39;</span><span class=p>:</span> <span class=s1>&#39;mean&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>analysis</span><span class=p>[</span><span class=s1>&#39;symbol_analysis&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>symbol_analysis</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>analysis</span>
</span></span></code></pre></td></tr></table></div></div></div></div><h2 id=参数优化方法>参数优化方法</h2><h3 id=网格搜索优化>网格搜索优化</h3><div class="not-prose my-8 overflow-hidden rounded-lg bg-gray-900 shadow-lg"><div class="p-4 overflow-x-auto"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ParameterOptimizer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;参数优化器&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>backtest_engine</span><span class=p>:</span> <span class=n>BacktestEngine</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>engine</span> <span class=o>=</span> <span class=n>backtest_engine</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>optimization_results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>best_params</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>best_performance</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>grid_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Any</span><span class=p>]],</span> 
</span></span><span class=line><span class=cl>                   <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                   <span class=n>optimization_metric</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;网格搜索优化&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;开始网格搜索参数优化...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 生成所有参数组合</span>
</span></span><span class=line><span class=cl>        <span class=n>param_combinations</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_param_combinations</span><span class=p>(</span><span class=n>param_grid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>total_combinations</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>param_combinations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;总共有 </span><span class=si>{</span><span class=n>total_combinations</span><span class=si>}</span><span class=s2> 种参数组合需要测试&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>best_metric</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
</span></span><span class=line><span class=cl>        <span class=n>best_params</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=n>optimization_results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>params</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>param_combinations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;测试参数组合 </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_combinations</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>params</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 运行回测</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_backtest_with_params</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>market_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>result</span> <span class=ow>and</span> <span class=n>optimization_metric</span> <span class=ow>in</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>metric_value</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>][</span><span class=n>optimization_metric</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 记录结果</span>
</span></span><span class=line><span class=cl>                <span class=n>optimization_results</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;params&#39;</span><span class=p>:</span> <span class=n>params</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;metrics&#39;</span><span class=p>:</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;metric_value&#39;</span><span class=p>:</span> <span class=n>metric_value</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 更新最佳参数</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>metric_value</span> <span class=o>&gt;</span> <span class=n>best_metric</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>best_metric</span> <span class=o>=</span> <span class=n>metric_value</span>
</span></span><span class=line><span class=cl>                    <span class=n>best_params</span> <span class=o>=</span> <span class=n>params</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>best_performance</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  找到更好的参数组合！</span><span class=si>{</span><span class=n>optimization_metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>metric_value</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>optimization_results</span> <span class=o>=</span> <span class=n>optimization_results</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>best_params</span> <span class=o>=</span> <span class=n>best_params</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;best_params&#39;</span><span class=p>:</span> <span class=n>best_params</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;best_metric&#39;</span><span class=p>:</span> <span class=n>best_metric</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;optimization_results&#39;</span><span class=p>:</span> <span class=n>optimization_results</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_combinations&#39;</span><span class=p>:</span> <span class=n>total_combinations</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_param_combinations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Any</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;生成参数组合&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>param_names</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>param_grid</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>param_values</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>param_grid</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>combinations</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=o>*</span><span class=n>param_values</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>param_names</span><span class=p>,</span> <span class=n>combo</span><span class=p>))</span> <span class=k>for</span> <span class=n>combo</span> <span class=ow>in</span> <span class=n>combinations</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run_backtest_with_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                               <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;使用指定参数运行回测&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 创建新的策略实例（这里简化处理，实际应该根据参数创建不同策略）</span>
</span></span><span class=line><span class=cl>            <span class=n>strategy_params</span> <span class=o>=</span> <span class=n>params</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 这里假设引擎有方法根据参数调整策略</span>
</span></span><span class=line><span class=cl>            <span class=c1># 实际实现中需要修改引擎使其支持参数化策略</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>engine</span><span class=o>.</span><span class=n>run_backtest</span><span class=p>(</span><span class=n>market_data</span><span class=p>,</span> <span class=n>strategy_params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;回测失败: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>random_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_distributions</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span> 
</span></span><span class=line><span class=cl>                     <span class=n>n_iterations</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                     <span class=n>optimization_metric</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;随机搜索优化&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;开始随机搜索参数优化（</span><span class=si>{</span><span class=n>n_iterations</span><span class=si>}</span><span class=s2>次迭代）...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>best_metric</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
</span></span><span class=line><span class=cl>        <span class=n>best_params</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=n>optimization_results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_iterations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 随机生成参数</span>
</span></span><span class=line><span class=cl>            <span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_random_params</span><span class=p>(</span><span class=n>param_distributions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;测试随机参数组合 </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>n_iterations</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>params</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 运行回测</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_backtest_with_params</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>market_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>result</span> <span class=ow>and</span> <span class=n>optimization_metric</span> <span class=ow>in</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>metric_value</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>][</span><span class=n>optimization_metric</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 记录结果</span>
</span></span><span class=line><span class=cl>                <span class=n>optimization_results</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;params&#39;</span><span class=p>:</span> <span class=n>params</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;metrics&#39;</span><span class=p>:</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;metric_value&#39;</span><span class=p>:</span> <span class=n>metric_value</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 更新最佳参数</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>metric_value</span> <span class=o>&gt;</span> <span class=n>best_metric</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>best_metric</span> <span class=o>=</span> <span class=n>metric_value</span>
</span></span><span class=line><span class=cl>                    <span class=n>best_params</span> <span class=o>=</span> <span class=n>params</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>best_performance</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  找到更好的参数组合！</span><span class=si>{</span><span class=n>optimization_metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>metric_value</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>optimization_results</span> <span class=o>=</span> <span class=n>optimization_results</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>best_params</span> <span class=o>=</span> <span class=n>best_params</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;best_params&#39;</span><span class=p>:</span> <span class=n>best_params</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;best_metric&#39;</span><span class=p>:</span> <span class=n>best_metric</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;optimization_results&#39;</span><span class=p>:</span> <span class=n>optimization_results</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_iterations&#39;</span><span class=p>:</span> <span class=n>n_iterations</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_random_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_distributions</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Any</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;生成随机参数&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>params</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>param_name</span><span class=p>,</span> <span class=p>(</span><span class=n>param_type</span><span class=p>,</span> <span class=n>param_range</span><span class=p>)</span> <span class=ow>in</span> <span class=n>param_distributions</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>param_type</span> <span class=o>==</span> <span class=s1>&#39;int&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>params</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=n>param_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>param_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>param_type</span> <span class=o>==</span> <span class=s1>&#39;float&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>params</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=n>param_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>param_range</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>param_type</span> <span class=o>==</span> <span class=s1>&#39;choice&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>params</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>param_range</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>params</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>bayesian_optimization</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_bounds</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]],</span> 
</span></span><span class=line><span class=cl>                            <span class=n>n_iterations</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=n>optimization_metric</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;贝叶斯优化&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=kn>from</span> <span class=nn>skopt</span> <span class=kn>import</span> <span class=n>gp_minimize</span>
</span></span><span class=line><span class=cl>            <span class=kn>from</span> <span class=nn>skopt.space</span> <span class=kn>import</span> <span class=n>Real</span><span class=p>,</span> <span class=n>Integer</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;开始贝叶斯参数优化（</span><span class=si>{</span><span class=n>n_iterations</span><span class=si>}</span><span class=s2>次迭代）...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 定义参数空间</span>
</span></span><span class=line><span class=cl>            <span class=n>search_space</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=n>param_names</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>param_name</span><span class=p>,</span> <span class=p>(</span><span class=n>param_type</span><span class=p>,</span> <span class=n>bounds</span><span class=p>)</span> <span class=ow>in</span> <span class=n>param_bounds</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>param_names</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>param_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>param_type</span> <span class=o>==</span> <span class=s1>&#39;int&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>search_space</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Integer</span><span class=p>(</span><span class=n>bounds</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>bounds</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=n>param_name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>param_type</span> <span class=o>==</span> <span class=s1>&#39;float&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>search_space</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Real</span><span class=p>(</span><span class=n>bounds</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>bounds</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=n>param_name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 定义目标函数</span>
</span></span><span class=line><span class=cl>            <span class=k>def</span> <span class=nf>objective_function</span><span class=p>(</span><span class=n>params</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>param_dict</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>param_names</span><span class=p>,</span> <span class=n>params</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 运行回测</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_backtest_with_params</span><span class=p>(</span><span class=n>param_dict</span><span class=p>,</span> <span class=n>market_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>result</span> <span class=ow>and</span> <span class=n>optimization_metric</span> <span class=ow>in</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 贝叶斯优化是求最小值，所以返回负值</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=o>-</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>][</span><span class=n>optimization_metric</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=mi>0</span>  <span class=c1># 返回一个较大的值表示失败</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 运行贝叶斯优化</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>gp_minimize</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>func</span><span class=o>=</span><span class=n>objective_function</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>dimensions</span><span class=o>=</span><span class=n>search_space</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>n_calls</span><span class=o>=</span><span class=n>n_iterations</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>n_initial_points</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 提取最佳参数</span>
</span></span><span class=line><span class=cl>            <span class=n>best_params</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>param_names</span><span class=p>,</span> <span class=n>result</span><span class=o>.</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>best_metric</span> <span class=o>=</span> <span class=o>-</span><span class=n>result</span><span class=o>.</span><span class=n>fun</span>  <span class=c1># 转换回正值</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>best_params</span> <span class=o>=</span> <span class=n>best_params</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;best_params&#39;</span><span class=p>:</span> <span class=n>best_params</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;best_metric&#39;</span><span class=p>:</span> <span class=n>best_metric</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;optimization_result&#39;</span><span class=p>:</span> <span class=n>result</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;total_iterations&#39;</span><span class=p>:</span> <span class=n>n_iterations</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;scikit-optimize未安装，请使用pip install scikit-optimize安装&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;贝叶斯优化失败: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span></code></pre></td></tr></table></div></div></div></div><h3 id=遗传算法优化>遗传算法优化</h3><div class="not-prose my-8 overflow-hidden rounded-lg bg-gray-900 shadow-lg"><div class="p-4 overflow-x-auto"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>   1
</span><span class=lnt>   2
</span><span class=lnt>   3
</span><span class=lnt>   4
</span><span class=lnt>   5
</span><span class=lnt>   6
</span><span class=lnt>   7
</span><span class=lnt>   8
</span><span class=lnt>   9
</span><span class=lnt>  10
</span><span class=lnt>  11
</span><span class=lnt>  12
</span><span class=lnt>  13
</span><span class=lnt>  14
</span><span class=lnt>  15
</span><span class=lnt>  16
</span><span class=lnt>  17
</span><span class=lnt>  18
</span><span class=lnt>  19
</span><span class=lnt>  20
</span><span class=lnt>  21
</span><span class=lnt>  22
</span><span class=lnt>  23
</span><span class=lnt>  24
</span><span class=lnt>  25
</span><span class=lnt>  26
</span><span class=lnt>  27
</span><span class=lnt>  28
</span><span class=lnt>  29
</span><span class=lnt>  30
</span><span class=lnt>  31
</span><span class=lnt>  32
</span><span class=lnt>  33
</span><span class=lnt>  34
</span><span class=lnt>  35
</span><span class=lnt>  36
</span><span class=lnt>  37
</span><span class=lnt>  38
</span><span class=lnt>  39
</span><span class=lnt>  40
</span><span class=lnt>  41
</span><span class=lnt>  42
</span><span class=lnt>  43
</span><span class=lnt>  44
</span><span class=lnt>  45
</span><span class=lnt>  46
</span><span class=lnt>  47
</span><span class=lnt>  48
</span><span class=lnt>  49
</span><span class=lnt>  50
</span><span class=lnt>  51
</span><span class=lnt>  52
</span><span class=lnt>  53
</span><span class=lnt>  54
</span><span class=lnt>  55
</span><span class=lnt>  56
</span><span class=lnt>  57
</span><span class=lnt>  58
</span><span class=lnt>  59
</span><span class=lnt>  60
</span><span class=lnt>  61
</span><span class=lnt>  62
</span><span class=lnt>  63
</span><span class=lnt>  64
</span><span class=lnt>  65
</span><span class=lnt>  66
</span><span class=lnt>  67
</span><span class=lnt>  68
</span><span class=lnt>  69
</span><span class=lnt>  70
</span><span class=lnt>  71
</span><span class=lnt>  72
</span><span class=lnt>  73
</span><span class=lnt>  74
</span><span class=lnt>  75
</span><span class=lnt>  76
</span><span class=lnt>  77
</span><span class=lnt>  78
</span><span class=lnt>  79
</span><span class=lnt>  80
</span><span class=lnt>  81
</span><span class=lnt>  82
</span><span class=lnt>  83
</span><span class=lnt>  84
</span><span class=lnt>  85
</span><span class=lnt>  86
</span><span class=lnt>  87
</span><span class=lnt>  88
</span><span class=lnt>  89
</span><span class=lnt>  90
</span><span class=lnt>  91
</span><span class=lnt>  92
</span><span class=lnt>  93
</span><span class=lnt>  94
</span><span class=lnt>  95
</span><span class=lnt>  96
</span><span class=lnt>  97
</span><span class=lnt>  98
</span><span class=lnt>  99
</span><span class=lnt> 100
</span><span class=lnt> 101
</span><span class=lnt> 102
</span><span class=lnt> 103
</span><span class=lnt> 104
</span><span class=lnt> 105
</span><span class=lnt> 106
</span><span class=lnt> 107
</span><span class=lnt> 108
</span><span class=lnt> 109
</span><span class=lnt> 110
</span><span class=lnt> 111
</span><span class=lnt> 112
</span><span class=lnt> 113
</span><span class=lnt> 114
</span><span class=lnt> 115
</span><span class=lnt> 116
</span><span class=lnt> 117
</span><span class=lnt> 118
</span><span class=lnt> 119
</span><span class=lnt> 120
</span><span class=lnt> 121
</span><span class=lnt> 122
</span><span class=lnt> 123
</span><span class=lnt> 124
</span><span class=lnt> 125
</span><span class=lnt> 126
</span><span class=lnt> 127
</span><span class=lnt> 128
</span><span class=lnt> 129
</span><span class=lnt> 130
</span><span class=lnt> 131
</span><span class=lnt> 132
</span><span class=lnt> 133
</span><span class=lnt> 134
</span><span class=lnt> 135
</span><span class=lnt> 136
</span><span class=lnt> 137
</span><span class=lnt> 138
</span><span class=lnt> 139
</span><span class=lnt> 140
</span><span class=lnt> 141
</span><span class=lnt> 142
</span><span class=lnt> 143
</span><span class=lnt> 144
</span><span class=lnt> 145
</span><span class=lnt> 146
</span><span class=lnt> 147
</span><span class=lnt> 148
</span><span class=lnt> 149
</span><span class=lnt> 150
</span><span class=lnt> 151
</span><span class=lnt> 152
</span><span class=lnt> 153
</span><span class=lnt> 154
</span><span class=lnt> 155
</span><span class=lnt> 156
</span><span class=lnt> 157
</span><span class=lnt> 158
</span><span class=lnt> 159
</span><span class=lnt> 160
</span><span class=lnt> 161
</span><span class=lnt> 162
</span><span class=lnt> 163
</span><span class=lnt> 164
</span><span class=lnt> 165
</span><span class=lnt> 166
</span><span class=lnt> 167
</span><span class=lnt> 168
</span><span class=lnt> 169
</span><span class=lnt> 170
</span><span class=lnt> 171
</span><span class=lnt> 172
</span><span class=lnt> 173
</span><span class=lnt> 174
</span><span class=lnt> 175
</span><span class=lnt> 176
</span><span class=lnt> 177
</span><span class=lnt> 178
</span><span class=lnt> 179
</span><span class=lnt> 180
</span><span class=lnt> 181
</span><span class=lnt> 182
</span><span class=lnt> 183
</span><span class=lnt> 184
</span><span class=lnt> 185
</span><span class=lnt> 186
</span><span class=lnt> 187
</span><span class=lnt> 188
</span><span class=lnt> 189
</span><span class=lnt> 190
</span><span class=lnt> 191
</span><span class=lnt> 192
</span><span class=lnt> 193
</span><span class=lnt> 194
</span><span class=lnt> 195
</span><span class=lnt> 196
</span><span class=lnt> 197
</span><span class=lnt> 198
</span><span class=lnt> 199
</span><span class=lnt> 200
</span><span class=lnt> 201
</span><span class=lnt> 202
</span><span class=lnt> 203
</span><span class=lnt> 204
</span><span class=lnt> 205
</span><span class=lnt> 206
</span><span class=lnt> 207
</span><span class=lnt> 208
</span><span class=lnt> 209
</span><span class=lnt> 210
</span><span class=lnt> 211
</span><span class=lnt> 212
</span><span class=lnt> 213
</span><span class=lnt> 214
</span><span class=lnt> 215
</span><span class=lnt> 216
</span><span class=lnt> 217
</span><span class=lnt> 218
</span><span class=lnt> 219
</span><span class=lnt> 220
</span><span class=lnt> 221
</span><span class=lnt> 222
</span><span class=lnt> 223
</span><span class=lnt> 224
</span><span class=lnt> 225
</span><span class=lnt> 226
</span><span class=lnt> 227
</span><span class=lnt> 228
</span><span class=lnt> 229
</span><span class=lnt> 230
</span><span class=lnt> 231
</span><span class=lnt> 232
</span><span class=lnt> 233
</span><span class=lnt> 234
</span><span class=lnt> 235
</span><span class=lnt> 236
</span><span class=lnt> 237
</span><span class=lnt> 238
</span><span class=lnt> 239
</span><span class=lnt> 240
</span><span class=lnt> 241
</span><span class=lnt> 242
</span><span class=lnt> 243
</span><span class=lnt> 244
</span><span class=lnt> 245
</span><span class=lnt> 246
</span><span class=lnt> 247
</span><span class=lnt> 248
</span><span class=lnt> 249
</span><span class=lnt> 250
</span><span class=lnt> 251
</span><span class=lnt> 252
</span><span class=lnt> 253
</span><span class=lnt> 254
</span><span class=lnt> 255
</span><span class=lnt> 256
</span><span class=lnt> 257
</span><span class=lnt> 258
</span><span class=lnt> 259
</span><span class=lnt> 260
</span><span class=lnt> 261
</span><span class=lnt> 262
</span><span class=lnt> 263
</span><span class=lnt> 264
</span><span class=lnt> 265
</span><span class=lnt> 266
</span><span class=lnt> 267
</span><span class=lnt> 268
</span><span class=lnt> 269
</span><span class=lnt> 270
</span><span class=lnt> 271
</span><span class=lnt> 272
</span><span class=lnt> 273
</span><span class=lnt> 274
</span><span class=lnt> 275
</span><span class=lnt> 276
</span><span class=lnt> 277
</span><span class=lnt> 278
</span><span class=lnt> 279
</span><span class=lnt> 280
</span><span class=lnt> 281
</span><span class=lnt> 282
</span><span class=lnt> 283
</span><span class=lnt> 284
</span><span class=lnt> 285
</span><span class=lnt> 286
</span><span class=lnt> 287
</span><span class=lnt> 288
</span><span class=lnt> 289
</span><span class=lnt> 290
</span><span class=lnt> 291
</span><span class=lnt> 292
</span><span class=lnt> 293
</span><span class=lnt> 294
</span><span class=lnt> 295
</span><span class=lnt> 296
</span><span class=lnt> 297
</span><span class=lnt> 298
</span><span class=lnt> 299
</span><span class=lnt> 300
</span><span class=lnt> 301
</span><span class=lnt> 302
</span><span class=lnt> 303
</span><span class=lnt> 304
</span><span class=lnt> 305
</span><span class=lnt> 306
</span><span class=lnt> 307
</span><span class=lnt> 308
</span><span class=lnt> 309
</span><span class=lnt> 310
</span><span class=lnt> 311
</span><span class=lnt> 312
</span><span class=lnt> 313
</span><span class=lnt> 314
</span><span class=lnt> 315
</span><span class=lnt> 316
</span><span class=lnt> 317
</span><span class=lnt> 318
</span><span class=lnt> 319
</span><span class=lnt> 320
</span><span class=lnt> 321
</span><span class=lnt> 322
</span><span class=lnt> 323
</span><span class=lnt> 324
</span><span class=lnt> 325
</span><span class=lnt> 326
</span><span class=lnt> 327
</span><span class=lnt> 328
</span><span class=lnt> 329
</span><span class=lnt> 330
</span><span class=lnt> 331
</span><span class=lnt> 332
</span><span class=lnt> 333
</span><span class=lnt> 334
</span><span class=lnt> 335
</span><span class=lnt> 336
</span><span class=lnt> 337
</span><span class=lnt> 338
</span><span class=lnt> 339
</span><span class=lnt> 340
</span><span class=lnt> 341
</span><span class=lnt> 342
</span><span class=lnt> 343
</span><span class=lnt> 344
</span><span class=lnt> 345
</span><span class=lnt> 346
</span><span class=lnt> 347
</span><span class=lnt> 348
</span><span class=lnt> 349
</span><span class=lnt> 350
</span><span class=lnt> 351
</span><span class=lnt> 352
</span><span class=lnt> 353
</span><span class=lnt> 354
</span><span class=lnt> 355
</span><span class=lnt> 356
</span><span class=lnt> 357
</span><span class=lnt> 358
</span><span class=lnt> 359
</span><span class=lnt> 360
</span><span class=lnt> 361
</span><span class=lnt> 362
</span><span class=lnt> 363
</span><span class=lnt> 364
</span><span class=lnt> 365
</span><span class=lnt> 366
</span><span class=lnt> 367
</span><span class=lnt> 368
</span><span class=lnt> 369
</span><span class=lnt> 370
</span><span class=lnt> 371
</span><span class=lnt> 372
</span><span class=lnt> 373
</span><span class=lnt> 374
</span><span class=lnt> 375
</span><span class=lnt> 376
</span><span class=lnt> 377
</span><span class=lnt> 378
</span><span class=lnt> 379
</span><span class=lnt> 380
</span><span class=lnt> 381
</span><span class=lnt> 382
</span><span class=lnt> 383
</span><span class=lnt> 384
</span><span class=lnt> 385
</span><span class=lnt> 386
</span><span class=lnt> 387
</span><span class=lnt> 388
</span><span class=lnt> 389
</span><span class=lnt> 390
</span><span class=lnt> 391
</span><span class=lnt> 392
</span><span class=lnt> 393
</span><span class=lnt> 394
</span><span class=lnt> 395
</span><span class=lnt> 396
</span><span class=lnt> 397
</span><span class=lnt> 398
</span><span class=lnt> 399
</span><span class=lnt> 400
</span><span class=lnt> 401
</span><span class=lnt> 402
</span><span class=lnt> 403
</span><span class=lnt> 404
</span><span class=lnt> 405
</span><span class=lnt> 406
</span><span class=lnt> 407
</span><span class=lnt> 408
</span><span class=lnt> 409
</span><span class=lnt> 410
</span><span class=lnt> 411
</span><span class=lnt> 412
</span><span class=lnt> 413
</span><span class=lnt> 414
</span><span class=lnt> 415
</span><span class=lnt> 416
</span><span class=lnt> 417
</span><span class=lnt> 418
</span><span class=lnt> 419
</span><span class=lnt> 420
</span><span class=lnt> 421
</span><span class=lnt> 422
</span><span class=lnt> 423
</span><span class=lnt> 424
</span><span class=lnt> 425
</span><span class=lnt> 426
</span><span class=lnt> 427
</span><span class=lnt> 428
</span><span class=lnt> 429
</span><span class=lnt> 430
</span><span class=lnt> 431
</span><span class=lnt> 432
</span><span class=lnt> 433
</span><span class=lnt> 434
</span><span class=lnt> 435
</span><span class=lnt> 436
</span><span class=lnt> 437
</span><span class=lnt> 438
</span><span class=lnt> 439
</span><span class=lnt> 440
</span><span class=lnt> 441
</span><span class=lnt> 442
</span><span class=lnt> 443
</span><span class=lnt> 444
</span><span class=lnt> 445
</span><span class=lnt> 446
</span><span class=lnt> 447
</span><span class=lnt> 448
</span><span class=lnt> 449
</span><span class=lnt> 450
</span><span class=lnt> 451
</span><span class=lnt> 452
</span><span class=lnt> 453
</span><span class=lnt> 454
</span><span class=lnt> 455
</span><span class=lnt> 456
</span><span class=lnt> 457
</span><span class=lnt> 458
</span><span class=lnt> 459
</span><span class=lnt> 460
</span><span class=lnt> 461
</span><span class=lnt> 462
</span><span class=lnt> 463
</span><span class=lnt> 464
</span><span class=lnt> 465
</span><span class=lnt> 466
</span><span class=lnt> 467
</span><span class=lnt> 468
</span><span class=lnt> 469
</span><span class=lnt> 470
</span><span class=lnt> 471
</span><span class=lnt> 472
</span><span class=lnt> 473
</span><span class=lnt> 474
</span><span class=lnt> 475
</span><span class=lnt> 476
</span><span class=lnt> 477
</span><span class=lnt> 478
</span><span class=lnt> 479
</span><span class=lnt> 480
</span><span class=lnt> 481
</span><span class=lnt> 482
</span><span class=lnt> 483
</span><span class=lnt> 484
</span><span class=lnt> 485
</span><span class=lnt> 486
</span><span class=lnt> 487
</span><span class=lnt> 488
</span><span class=lnt> 489
</span><span class=lnt> 490
</span><span class=lnt> 491
</span><span class=lnt> 492
</span><span class=lnt> 493
</span><span class=lnt> 494
</span><span class=lnt> 495
</span><span class=lnt> 496
</span><span class=lnt> 497
</span><span class=lnt> 498
</span><span class=lnt> 499
</span><span class=lnt> 500
</span><span class=lnt> 501
</span><span class=lnt> 502
</span><span class=lnt> 503
</span><span class=lnt> 504
</span><span class=lnt> 505
</span><span class=lnt> 506
</span><span class=lnt> 507
</span><span class=lnt> 508
</span><span class=lnt> 509
</span><span class=lnt> 510
</span><span class=lnt> 511
</span><span class=lnt> 512
</span><span class=lnt> 513
</span><span class=lnt> 514
</span><span class=lnt> 515
</span><span class=lnt> 516
</span><span class=lnt> 517
</span><span class=lnt> 518
</span><span class=lnt> 519
</span><span class=lnt> 520
</span><span class=lnt> 521
</span><span class=lnt> 522
</span><span class=lnt> 523
</span><span class=lnt> 524
</span><span class=lnt> 525
</span><span class=lnt> 526
</span><span class=lnt> 527
</span><span class=lnt> 528
</span><span class=lnt> 529
</span><span class=lnt> 530
</span><span class=lnt> 531
</span><span class=lnt> 532
</span><span class=lnt> 533
</span><span class=lnt> 534
</span><span class=lnt> 535
</span><span class=lnt> 536
</span><span class=lnt> 537
</span><span class=lnt> 538
</span><span class=lnt> 539
</span><span class=lnt> 540
</span><span class=lnt> 541
</span><span class=lnt> 542
</span><span class=lnt> 543
</span><span class=lnt> 544
</span><span class=lnt> 545
</span><span class=lnt> 546
</span><span class=lnt> 547
</span><span class=lnt> 548
</span><span class=lnt> 549
</span><span class=lnt> 550
</span><span class=lnt> 551
</span><span class=lnt> 552
</span><span class=lnt> 553
</span><span class=lnt> 554
</span><span class=lnt> 555
</span><span class=lnt> 556
</span><span class=lnt> 557
</span><span class=lnt> 558
</span><span class=lnt> 559
</span><span class=lnt> 560
</span><span class=lnt> 561
</span><span class=lnt> 562
</span><span class=lnt> 563
</span><span class=lnt> 564
</span><span class=lnt> 565
</span><span class=lnt> 566
</span><span class=lnt> 567
</span><span class=lnt> 568
</span><span class=lnt> 569
</span><span class=lnt> 570
</span><span class=lnt> 571
</span><span class=lnt> 572
</span><span class=lnt> 573
</span><span class=lnt> 574
</span><span class=lnt> 575
</span><span class=lnt> 576
</span><span class=lnt> 577
</span><span class=lnt> 578
</span><span class=lnt> 579
</span><span class=lnt> 580
</span><span class=lnt> 581
</span><span class=lnt> 582
</span><span class=lnt> 583
</span><span class=lnt> 584
</span><span class=lnt> 585
</span><span class=lnt> 586
</span><span class=lnt> 587
</span><span class=lnt> 588
</span><span class=lnt> 589
</span><span class=lnt> 590
</span><span class=lnt> 591
</span><span class=lnt> 592
</span><span class=lnt> 593
</span><span class=lnt> 594
</span><span class=lnt> 595
</span><span class=lnt> 596
</span><span class=lnt> 597
</span><span class=lnt> 598
</span><span class=lnt> 599
</span><span class=lnt> 600
</span><span class=lnt> 601
</span><span class=lnt> 602
</span><span class=lnt> 603
</span><span class=lnt> 604
</span><span class=lnt> 605
</span><span class=lnt> 606
</span><span class=lnt> 607
</span><span class=lnt> 608
</span><span class=lnt> 609
</span><span class=lnt> 610
</span><span class=lnt> 611
</span><span class=lnt> 612
</span><span class=lnt> 613
</span><span class=lnt> 614
</span><span class=lnt> 615
</span><span class=lnt> 616
</span><span class=lnt> 617
</span><span class=lnt> 618
</span><span class=lnt> 619
</span><span class=lnt> 620
</span><span class=lnt> 621
</span><span class=lnt> 622
</span><span class=lnt> 623
</span><span class=lnt> 624
</span><span class=lnt> 625
</span><span class=lnt> 626
</span><span class=lnt> 627
</span><span class=lnt> 628
</span><span class=lnt> 629
</span><span class=lnt> 630
</span><span class=lnt> 631
</span><span class=lnt> 632
</span><span class=lnt> 633
</span><span class=lnt> 634
</span><span class=lnt> 635
</span><span class=lnt> 636
</span><span class=lnt> 637
</span><span class=lnt> 638
</span><span class=lnt> 639
</span><span class=lnt> 640
</span><span class=lnt> 641
</span><span class=lnt> 642
</span><span class=lnt> 643
</span><span class=lnt> 644
</span><span class=lnt> 645
</span><span class=lnt> 646
</span><span class=lnt> 647
</span><span class=lnt> 648
</span><span class=lnt> 649
</span><span class=lnt> 650
</span><span class=lnt> 651
</span><span class=lnt> 652
</span><span class=lnt> 653
</span><span class=lnt> 654
</span><span class=lnt> 655
</span><span class=lnt> 656
</span><span class=lnt> 657
</span><span class=lnt> 658
</span><span class=lnt> 659
</span><span class=lnt> 660
</span><span class=lnt> 661
</span><span class=lnt> 662
</span><span class=lnt> 663
</span><span class=lnt> 664
</span><span class=lnt> 665
</span><span class=lnt> 666
</span><span class=lnt> 667
</span><span class=lnt> 668
</span><span class=lnt> 669
</span><span class=lnt> 670
</span><span class=lnt> 671
</span><span class=lnt> 672
</span><span class=lnt> 673
</span><span class=lnt> 674
</span><span class=lnt> 675
</span><span class=lnt> 676
</span><span class=lnt> 677
</span><span class=lnt> 678
</span><span class=lnt> 679
</span><span class=lnt> 680
</span><span class=lnt> 681
</span><span class=lnt> 682
</span><span class=lnt> 683
</span><span class=lnt> 684
</span><span class=lnt> 685
</span><span class=lnt> 686
</span><span class=lnt> 687
</span><span class=lnt> 688
</span><span class=lnt> 689
</span><span class=lnt> 690
</span><span class=lnt> 691
</span><span class=lnt> 692
</span><span class=lnt> 693
</span><span class=lnt> 694
</span><span class=lnt> 695
</span><span class=lnt> 696
</span><span class=lnt> 697
</span><span class=lnt> 698
</span><span class=lnt> 699
</span><span class=lnt> 700
</span><span class=lnt> 701
</span><span class=lnt> 702
</span><span class=lnt> 703
</span><span class=lnt> 704
</span><span class=lnt> 705
</span><span class=lnt> 706
</span><span class=lnt> 707
</span><span class=lnt> 708
</span><span class=lnt> 709
</span><span class=lnt> 710
</span><span class=lnt> 711
</span><span class=lnt> 712
</span><span class=lnt> 713
</span><span class=lnt> 714
</span><span class=lnt> 715
</span><span class=lnt> 716
</span><span class=lnt> 717
</span><span class=lnt> 718
</span><span class=lnt> 719
</span><span class=lnt> 720
</span><span class=lnt> 721
</span><span class=lnt> 722
</span><span class=lnt> 723
</span><span class=lnt> 724
</span><span class=lnt> 725
</span><span class=lnt> 726
</span><span class=lnt> 727
</span><span class=lnt> 728
</span><span class=lnt> 729
</span><span class=lnt> 730
</span><span class=lnt> 731
</span><span class=lnt> 732
</span><span class=lnt> 733
</span><span class=lnt> 734
</span><span class=lnt> 735
</span><span class=lnt> 736
</span><span class=lnt> 737
</span><span class=lnt> 738
</span><span class=lnt> 739
</span><span class=lnt> 740
</span><span class=lnt> 741
</span><span class=lnt> 742
</span><span class=lnt> 743
</span><span class=lnt> 744
</span><span class=lnt> 745
</span><span class=lnt> 746
</span><span class=lnt> 747
</span><span class=lnt> 748
</span><span class=lnt> 749
</span><span class=lnt> 750
</span><span class=lnt> 751
</span><span class=lnt> 752
</span><span class=lnt> 753
</span><span class=lnt> 754
</span><span class=lnt> 755
</span><span class=lnt> 756
</span><span class=lnt> 757
</span><span class=lnt> 758
</span><span class=lnt> 759
</span><span class=lnt> 760
</span><span class=lnt> 761
</span><span class=lnt> 762
</span><span class=lnt> 763
</span><span class=lnt> 764
</span><span class=lnt> 765
</span><span class=lnt> 766
</span><span class=lnt> 767
</span><span class=lnt> 768
</span><span class=lnt> 769
</span><span class=lnt> 770
</span><span class=lnt> 771
</span><span class=lnt> 772
</span><span class=lnt> 773
</span><span class=lnt> 774
</span><span class=lnt> 775
</span><span class=lnt> 776
</span><span class=lnt> 777
</span><span class=lnt> 778
</span><span class=lnt> 779
</span><span class=lnt> 780
</span><span class=lnt> 781
</span><span class=lnt> 782
</span><span class=lnt> 783
</span><span class=lnt> 784
</span><span class=lnt> 785
</span><span class=lnt> 786
</span><span class=lnt> 787
</span><span class=lnt> 788
</span><span class=lnt> 789
</span><span class=lnt> 790
</span><span class=lnt> 791
</span><span class=lnt> 792
</span><span class=lnt> 793
</span><span class=lnt> 794
</span><span class=lnt> 795
</span><span class=lnt> 796
</span><span class=lnt> 797
</span><span class=lnt> 798
</span><span class=lnt> 799
</span><span class=lnt> 800
</span><span class=lnt> 801
</span><span class=lnt> 802
</span><span class=lnt> 803
</span><span class=lnt> 804
</span><span class=lnt> 805
</span><span class=lnt> 806
</span><span class=lnt> 807
</span><span class=lnt> 808
</span><span class=lnt> 809
</span><span class=lnt> 810
</span><span class=lnt> 811
</span><span class=lnt> 812
</span><span class=lnt> 813
</span><span class=lnt> 814
</span><span class=lnt> 815
</span><span class=lnt> 816
</span><span class=lnt> 817
</span><span class=lnt> 818
</span><span class=lnt> 819
</span><span class=lnt> 820
</span><span class=lnt> 821
</span><span class=lnt> 822
</span><span class=lnt> 823
</span><span class=lnt> 824
</span><span class=lnt> 825
</span><span class=lnt> 826
</span><span class=lnt> 827
</span><span class=lnt> 828
</span><span class=lnt> 829
</span><span class=lnt> 830
</span><span class=lnt> 831
</span><span class=lnt> 832
</span><span class=lnt> 833
</span><span class=lnt> 834
</span><span class=lnt> 835
</span><span class=lnt> 836
</span><span class=lnt> 837
</span><span class=lnt> 838
</span><span class=lnt> 839
</span><span class=lnt> 840
</span><span class=lnt> 841
</span><span class=lnt> 842
</span><span class=lnt> 843
</span><span class=lnt> 844
</span><span class=lnt> 845
</span><span class=lnt> 846
</span><span class=lnt> 847
</span><span class=lnt> 848
</span><span class=lnt> 849
</span><span class=lnt> 850
</span><span class=lnt> 851
</span><span class=lnt> 852
</span><span class=lnt> 853
</span><span class=lnt> 854
</span><span class=lnt> 855
</span><span class=lnt> 856
</span><span class=lnt> 857
</span><span class=lnt> 858
</span><span class=lnt> 859
</span><span class=lnt> 860
</span><span class=lnt> 861
</span><span class=lnt> 862
</span><span class=lnt> 863
</span><span class=lnt> 864
</span><span class=lnt> 865
</span><span class=lnt> 866
</span><span class=lnt> 867
</span><span class=lnt> 868
</span><span class=lnt> 869
</span><span class=lnt> 870
</span><span class=lnt> 871
</span><span class=lnt> 872
</span><span class=lnt> 873
</span><span class=lnt> 874
</span><span class=lnt> 875
</span><span class=lnt> 876
</span><span class=lnt> 877
</span><span class=lnt> 878
</span><span class=lnt> 879
</span><span class=lnt> 880
</span><span class=lnt> 881
</span><span class=lnt> 882
</span><span class=lnt> 883
</span><span class=lnt> 884
</span><span class=lnt> 885
</span><span class=lnt> 886
</span><span class=lnt> 887
</span><span class=lnt> 888
</span><span class=lnt> 889
</span><span class=lnt> 890
</span><span class=lnt> 891
</span><span class=lnt> 892
</span><span class=lnt> 893
</span><span class=lnt> 894
</span><span class=lnt> 895
</span><span class=lnt> 896
</span><span class=lnt> 897
</span><span class=lnt> 898
</span><span class=lnt> 899
</span><span class=lnt> 900
</span><span class=lnt> 901
</span><span class=lnt> 902
</span><span class=lnt> 903
</span><span class=lnt> 904
</span><span class=lnt> 905
</span><span class=lnt> 906
</span><span class=lnt> 907
</span><span class=lnt> 908
</span><span class=lnt> 909
</span><span class=lnt> 910
</span><span class=lnt> 911
</span><span class=lnt> 912
</span><span class=lnt> 913
</span><span class=lnt> 914
</span><span class=lnt> 915
</span><span class=lnt> 916
</span><span class=lnt> 917
</span><span class=lnt> 918
</span><span class=lnt> 919
</span><span class=lnt> 920
</span><span class=lnt> 921
</span><span class=lnt> 922
</span><span class=lnt> 923
</span><span class=lnt> 924
</span><span class=lnt> 925
</span><span class=lnt> 926
</span><span class=lnt> 927
</span><span class=lnt> 928
</span><span class=lnt> 929
</span><span class=lnt> 930
</span><span class=lnt> 931
</span><span class=lnt> 932
</span><span class=lnt> 933
</span><span class=lnt> 934
</span><span class=lnt> 935
</span><span class=lnt> 936
</span><span class=lnt> 937
</span><span class=lnt> 938
</span><span class=lnt> 939
</span><span class=lnt> 940
</span><span class=lnt> 941
</span><span class=lnt> 942
</span><span class=lnt> 943
</span><span class=lnt> 944
</span><span class=lnt> 945
</span><span class=lnt> 946
</span><span class=lnt> 947
</span><span class=lnt> 948
</span><span class=lnt> 949
</span><span class=lnt> 950
</span><span class=lnt> 951
</span><span class=lnt> 952
</span><span class=lnt> 953
</span><span class=lnt> 954
</span><span class=lnt> 955
</span><span class=lnt> 956
</span><span class=lnt> 957
</span><span class=lnt> 958
</span><span class=lnt> 959
</span><span class=lnt> 960
</span><span class=lnt> 961
</span><span class=lnt> 962
</span><span class=lnt> 963
</span><span class=lnt> 964
</span><span class=lnt> 965
</span><span class=lnt> 966
</span><span class=lnt> 967
</span><span class=lnt> 968
</span><span class=lnt> 969
</span><span class=lnt> 970
</span><span class=lnt> 971
</span><span class=lnt> 972
</span><span class=lnt> 973
</span><span class=lnt> 974
</span><span class=lnt> 975
</span><span class=lnt> 976
</span><span class=lnt> 977
</span><span class=lnt> 978
</span><span class=lnt> 979
</span><span class=lnt> 980
</span><span class=lnt> 981
</span><span class=lnt> 982
</span><span class=lnt> 983
</span><span class=lnt> 984
</span><span class=lnt> 985
</span><span class=lnt> 986
</span><span class=lnt> 987
</span><span class=lnt> 988
</span><span class=lnt> 989
</span><span class=lnt> 990
</span><span class=lnt> 991
</span><span class=lnt> 992
</span><span class=lnt> 993
</span><span class=lnt> 994
</span><span class=lnt> 995
</span><span class=lnt> 996
</span><span class=lnt> 997
</span><span class=lnt> 998
</span><span class=lnt> 999
</span><span class=lnt>1000
</span><span class=lnt>1001
</span><span class=lnt>1002
</span><span class=lnt>1003
</span><span class=lnt>1004
</span><span class=lnt>1005
</span><span class=lnt>1006
</span><span class=lnt>1007
</span><span class=lnt>1008
</span><span class=lnt>1009
</span><span class=lnt>1010
</span><span class=lnt>1011
</span><span class=lnt>1012
</span><span class=lnt>1013
</span><span class=lnt>1014
</span><span class=lnt>1015
</span><span class=lnt>1016
</span><span class=lnt>1017
</span><span class=lnt>1018
</span><span class=lnt>1019
</span><span class=lnt>1020
</span><span class=lnt>1021
</span><span class=lnt>1022
</span><span class=lnt>1023
</span><span class=lnt>1024
</span><span class=lnt>1025
</span><span class=lnt>1026
</span><span class=lnt>1027
</span><span class=lnt>1028
</span><span class=lnt>1029
</span><span class=lnt>1030
</span><span class=lnt>1031
</span><span class=lnt>1032
</span><span class=lnt>1033
</span><span class=lnt>1034
</span><span class=lnt>1035
</span><span class=lnt>1036
</span><span class=lnt>1037
</span><span class=lnt>1038
</span><span class=lnt>1039
</span><span class=lnt>1040
</span><span class=lnt>1041
</span><span class=lnt>1042
</span><span class=lnt>1043
</span><span class=lnt>1044
</span><span class=lnt>1045
</span><span class=lnt>1046
</span><span class=lnt>1047
</span><span class=lnt>1048
</span><span class=lnt>1049
</span><span class=lnt>1050
</span><span class=lnt>1051
</span><span class=lnt>1052
</span><span class=lnt>1053
</span><span class=lnt>1054
</span><span class=lnt>1055
</span><span class=lnt>1056
</span><span class=lnt>1057
</span><span class=lnt>1058
</span><span class=lnt>1059
</span><span class=lnt>1060
</span><span class=lnt>1061
</span><span class=lnt>1062
</span><span class=lnt>1063
</span><span class=lnt>1064
</span><span class=lnt>1065
</span><span class=lnt>1066
</span><span class=lnt>1067
</span><span class=lnt>1068
</span><span class=lnt>1069
</span><span class=lnt>1070
</span><span class=lnt>1071
</span><span class=lnt>1072
</span><span class=lnt>1073
</span><span class=lnt>1074
</span><span class=lnt>1075
</span><span class=lnt>1076
</span><span class=lnt>1077
</span><span class=lnt>1078
</span><span class=lnt>1079
</span><span class=lnt>1080
</span><span class=lnt>1081
</span><span class=lnt>1082
</span><span class=lnt>1083
</span><span class=lnt>1084
</span><span class=lnt>1085
</span><span class=lnt>1086
</span><span class=lnt>1087
</span><span class=lnt>1088
</span><span class=lnt>1089
</span><span class=lnt>1090
</span><span class=lnt>1091
</span><span class=lnt>1092
</span><span class=lnt>1093
</span><span class=lnt>1094
</span><span class=lnt>1095
</span><span class=lnt>1096
</span><span class=lnt>1097
</span><span class=lnt>1098
</span><span class=lnt>1099
</span><span class=lnt>1100
</span><span class=lnt>1101
</span><span class=lnt>1102
</span><span class=lnt>1103
</span><span class=lnt>1104
</span><span class=lnt>1105
</span><span class=lnt>1106
</span><span class=lnt>1107
</span><span class=lnt>1108
</span><span class=lnt>1109
</span><span class=lnt>1110
</span><span class=lnt>1111
</span><span class=lnt>1112
</span><span class=lnt>1113
</span><span class=lnt>1114
</span><span class=lnt>1115
</span><span class=lnt>1116
</span><span class=lnt>1117
</span><span class=lnt>1118
</span><span class=lnt>1119
</span><span class=lnt>1120
</span><span class=lnt>1121
</span><span class=lnt>1122
</span><span class=lnt>1123
</span><span class=lnt>1124
</span><span class=lnt>1125
</span><span class=lnt>1126
</span><span class=lnt>1127
</span><span class=lnt>1128
</span><span class=lnt>1129
</span><span class=lnt>1130
</span><span class=lnt>1131
</span><span class=lnt>1132
</span><span class=lnt>1133
</span><span class=lnt>1134
</span><span class=lnt>1135
</span><span class=lnt>1136
</span><span class=lnt>1137
</span><span class=lnt>1138
</span><span class=lnt>1139
</span><span class=lnt>1140
</span><span class=lnt>1141
</span><span class=lnt>1142
</span><span class=lnt>1143
</span><span class=lnt>1144
</span><span class=lnt>1145
</span><span class=lnt>1146
</span><span class=lnt>1147
</span><span class=lnt>1148
</span><span class=lnt>1149
</span><span class=lnt>1150
</span><span class=lnt>1151
</span><span class=lnt>1152
</span><span class=lnt>1153
</span><span class=lnt>1154
</span><span class=lnt>1155
</span><span class=lnt>1156
</span><span class=lnt>1157
</span><span class=lnt>1158
</span><span class=lnt>1159
</span><span class=lnt>1160
</span><span class=lnt>1161
</span><span class=lnt>1162
</span><span class=lnt>1163
</span><span class=lnt>1164
</span><span class=lnt>1165
</span><span class=lnt>1166
</span><span class=lnt>1167
</span><span class=lnt>1168
</span><span class=lnt>1169
</span><span class=lnt>1170
</span><span class=lnt>1171
</span><span class=lnt>1172
</span><span class=lnt>1173
</span><span class=lnt>1174
</span><span class=lnt>1175
</span><span class=lnt>1176
</span><span class=lnt>1177
</span><span class=lnt>1178
</span><span class=lnt>1179
</span><span class=lnt>1180
</span><span class=lnt>1181
</span><span class=lnt>1182
</span><span class=lnt>1183
</span><span class=lnt>1184
</span><span class=lnt>1185
</span><span class=lnt>1186
</span><span class=lnt>1187
</span><span class=lnt>1188
</span><span class=lnt>1189
</span><span class=lnt>1190
</span><span class=lnt>1191
</span><span class=lnt>1192
</span><span class=lnt>1193
</span><span class=lnt>1194
</span><span class=lnt>1195
</span><span class=lnt>1196
</span><span class=lnt>1197
</span><span class=lnt>1198
</span><span class=lnt>1199
</span><span class=lnt>1200
</span><span class=lnt>1201
</span><span class=lnt>1202
</span><span class=lnt>1203
</span><span class=lnt>1204
</span><span class=lnt>1205
</span><span class=lnt>1206
</span><span class=lnt>1207
</span><span class=lnt>1208
</span><span class=lnt>1209
</span><span class=lnt>1210
</span><span class=lnt>1211
</span><span class=lnt>1212
</span><span class=lnt>1213
</span><span class=lnt>1214
</span><span class=lnt>1215
</span><span class=lnt>1216
</span><span class=lnt>1217
</span><span class=lnt>1218
</span><span class=lnt>1219
</span><span class=lnt>1220
</span><span class=lnt>1221
</span><span class=lnt>1222
</span><span class=lnt>1223
</span><span class=lnt>1224
</span><span class=lnt>1225
</span><span class=lnt>1226
</span><span class=lnt>1227
</span><span class=lnt>1228
</span><span class=lnt>1229
</span><span class=lnt>1230
</span><span class=lnt>1231
</span><span class=lnt>1232
</span><span class=lnt>1233
</span><span class=lnt>1234
</span><span class=lnt>1235
</span><span class=lnt>1236
</span><span class=lnt>1237
</span><span class=lnt>1238
</span><span class=lnt>1239
</span><span class=lnt>1240
</span><span class=lnt>1241
</span><span class=lnt>1242
</span><span class=lnt>1243
</span><span class=lnt>1244
</span><span class=lnt>1245
</span><span class=lnt>1246
</span><span class=lnt>1247
</span><span class=lnt>1248
</span><span class=lnt>1249
</span><span class=lnt>1250
</span><span class=lnt>1251
</span><span class=lnt>1252
</span><span class=lnt>1253
</span><span class=lnt>1254
</span><span class=lnt>1255
</span><span class=lnt>1256
</span><span class=lnt>1257
</span><span class=lnt>1258
</span><span class=lnt>1259
</span><span class=lnt>1260
</span><span class=lnt>1261
</span><span class=lnt>1262
</span><span class=lnt>1263
</span><span class=lnt>1264
</span><span class=lnt>1265
</span><span class=lnt>1266
</span><span class=lnt>1267
</span><span class=lnt>1268
</span><span class=lnt>1269
</span><span class=lnt>1270
</span><span class=lnt>1271
</span><span class=lnt>1272
</span><span class=lnt>1273
</span><span class=lnt>1274
</span><span class=lnt>1275
</span><span class=lnt>1276
</span><span class=lnt>1277
</span><span class=lnt>1278
</span><span class=lnt>1279
</span><span class=lnt>1280
</span><span class=lnt>1281
</span><span class=lnt>1282
</span><span class=lnt>1283
</span><span class=lnt>1284
</span><span class=lnt>1285
</span><span class=lnt>1286
</span><span class=lnt>1287
</span><span class=lnt>1288
</span><span class=lnt>1289
</span><span class=lnt>1290
</span><span class=lnt>1291
</span><span class=lnt>1292
</span><span class=lnt>1293
</span><span class=lnt>1294
</span><span class=lnt>1295
</span><span class=lnt>1296
</span><span class=lnt>1297
</span><span class=lnt>1298
</span><span class=lnt>1299
</span><span class=lnt>1300
</span><span class=lnt>1301
</span><span class=lnt>1302
</span><span class=lnt>1303
</span><span class=lnt>1304
</span><span class=lnt>1305
</span><span class=lnt>1306
</span><span class=lnt>1307
</span><span class=lnt>1308
</span><span class=lnt>1309
</span><span class=lnt>1310
</span><span class=lnt>1311
</span><span class=lnt>1312
</span><span class=lnt>1313
</span><span class=lnt>1314
</span><span class=lnt>1315
</span><span class=lnt>1316
</span><span class=lnt>1317
</span><span class=lnt>1318
</span><span class=lnt>1319
</span><span class=lnt>1320
</span><span class=lnt>1321
</span><span class=lnt>1322
</span><span class=lnt>1323
</span><span class=lnt>1324
</span><span class=lnt>1325
</span><span class=lnt>1326
</span><span class=lnt>1327
</span><span class=lnt>1328
</span><span class=lnt>1329
</span><span class=lnt>1330
</span><span class=lnt>1331
</span><span class=lnt>1332
</span><span class=lnt>1333
</span><span class=lnt>1334
</span><span class=lnt>1335
</span><span class=lnt>1336
</span><span class=lnt>1337
</span><span class=lnt>1338
</span><span class=lnt>1339
</span><span class=lnt>1340
</span><span class=lnt>1341
</span><span class=lnt>1342
</span><span class=lnt>1343
</span><span class=lnt>1344
</span><span class=lnt>1345
</span><span class=lnt>1346
</span><span class=lnt>1347
</span><span class=lnt>1348
</span><span class=lnt>1349
</span><span class=lnt>1350
</span><span class=lnt>1351
</span><span class=lnt>1352
</span><span class=lnt>1353
</span><span class=lnt>1354
</span><span class=lnt>1355
</span><span class=lnt>1356
</span><span class=lnt>1357
</span><span class=lnt>1358
</span><span class=lnt>1359
</span><span class=lnt>1360
</span><span class=lnt>1361
</span><span class=lnt>1362
</span><span class=lnt>1363
</span><span class=lnt>1364
</span><span class=lnt>1365
</span><span class=lnt>1366
</span><span class=lnt>1367
</span><span class=lnt>1368
</span><span class=lnt>1369
</span><span class=lnt>1370
</span><span class=lnt>1371
</span><span class=lnt>1372
</span><span class=lnt>1373
</span><span class=lnt>1374
</span><span class=lnt>1375
</span><span class=lnt>1376
</span><span class=lnt>1377
</span><span class=lnt>1378
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GeneticAlgorithmOptimizer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;遗传算法优化器&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>population_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>50</span><span class=p>,</span> <span class=n>generations</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>mutation_rate</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>crossover_rate</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>population_size</span> <span class=o>=</span> <span class=n>population_size</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>generations</span> <span class=o>=</span> <span class=n>generations</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>mutation_rate</span> <span class=o>=</span> <span class=n>mutation_rate</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>crossover_rate</span> <span class=o>=</span> <span class=n>crossover_rate</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>population</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>fitness_history</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>optimize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_bounds</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                <span class=n>backtest_func</span><span class=p>,</span> <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>optimization_metric</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;sharpe_ratio&#39;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;遗传算法优化&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;开始遗传算法优化（种群大小: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>population_size</span><span class=si>}</span><span class=s2>, 代数: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>generations</span><span class=si>}</span><span class=s2>）...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 初始化种群</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>population</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>initialize_population</span><span class=p>(</span><span class=n>param_bounds</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>best_individual</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=n>best_fitness</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>generation</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>generations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;第 </span><span class=si>{</span><span class=n>generation</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> 代优化...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 评估适应度</span>
</span></span><span class=line><span class=cl>            <span class=n>fitness_scores</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>individual</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>population</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>fitness</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>evaluate_fitness</span><span class=p>(</span><span class=n>individual</span><span class=p>,</span> <span class=n>backtest_func</span><span class=p>,</span> <span class=n>market_data</span><span class=p>,</span> <span class=n>optimization_metric</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>fitness_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fitness</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>fitness</span> <span class=o>&gt;</span> <span class=n>best_fitness</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>best_fitness</span> <span class=o>=</span> <span class=n>fitness</span>
</span></span><span class=line><span class=cl>                    <span class=n>best_individual</span> <span class=o>=</span> <span class=n>individual</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>fitness_history</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;generation&#39;</span><span class=p>:</span> <span class=n>generation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;best_fitness&#39;</span><span class=p>:</span> <span class=n>best_fitness</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;avg_fitness&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>fitness_scores</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  最佳适应度: </span><span class=si>{</span><span class=n>best_fitness</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 选择</span>
</span></span><span class=line><span class=cl>            <span class=n>selected_population</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>selection</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>population</span><span class=p>,</span> <span class=n>fitness_scores</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 交叉</span>
</span></span><span class=line><span class=cl>            <span class=n>offspring</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>crossover</span><span class=p>(</span><span class=n>selected_population</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 变异</span>
</span></span><span class=line><span class=cl>            <span class=n>mutated_offspring</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutation</span><span class=p>(</span><span class=n>offspring</span><span class=p>,</span> <span class=n>param_bounds</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 更新种群</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>population</span> <span class=o>=</span> <span class=n>mutated_offspring</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;best_params&#39;</span><span class=p>:</span> <span class=n>best_individual</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;best_fitness&#39;</span><span class=p>:</span> <span class=n>best_fitness</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;fitness_history&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>fitness_history</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>initialize_population</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param_bounds</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;初始化种群&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>population</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>population_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>individual</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>param_name</span><span class=p>,</span> <span class=n>param_config</span> <span class=ow>in</span> <span class=n>param_bounds</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;int&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>individual</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;float&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>individual</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;choice&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>individual</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;choices&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>population</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>individual</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>population</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>evaluate_fitness</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>individual</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>backtest_func</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                          <span class=n>market_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                          <span class=n>optimization_metric</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;评估适应度&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 运行回测</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>backtest_func</span><span class=p>(</span><span class=n>individual</span><span class=p>,</span> <span class=n>market_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>result</span> <span class=ow>and</span> <span class=n>optimization_metric</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>,</span> <span class=p>{}):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;performance_metrics&#39;</span><span class=p>][</span><span class=n>optimization_metric</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>  <span class=c1># 返回负无穷表示失败</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;适应度评估失败: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>selection</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>population</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span> 
</span></span><span class=line><span class=cl>                   <span class=n>fitness_scores</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;选择操作（锦标赛选择）&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>selected</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>population</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 随机选择3个个体进行锦标赛</span>
</span></span><span class=line><span class=cl>            <span class=n>tournament_indices</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>population</span><span class=p>),</span> <span class=mi>3</span><span class=p>,</span> <span class=n>replace</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>tournament_fitness</span> <span class=o>=</span> <span class=p>[</span><span class=n>fitness_scores</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>tournament_indices</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>winner_idx</span> <span class=o>=</span> <span class=n>tournament_indices</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>tournament_fitness</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>            <span class=n>selected</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>population</span><span class=p>[</span><span class=n>winner_idx</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>selected</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>crossover</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>population</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;交叉操作&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>offspring</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>population</span><span class=p>),</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>parent1</span> <span class=o>=</span> <span class=n>population</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>parent2</span> <span class=o>=</span> <span class=n>population</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=k>if</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>population</span><span class=p>)</span> <span class=k>else</span> <span class=n>population</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>crossover_rate</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 单点交叉</span>
</span></span><span class=line><span class=cl>                <span class=n>child1</span><span class=p>,</span> <span class=n>child2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>single_point_crossover</span><span class=p>(</span><span class=n>parent1</span><span class=p>,</span> <span class=n>parent2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>offspring</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>child1</span><span class=p>,</span> <span class=n>child2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>offspring</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>parent1</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span> <span class=n>parent2</span><span class=o>.</span><span class=n>copy</span><span class=p>()])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>offspring</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=n>population</span><span class=p>)]</span>  <span class=c1># 保持种群大小</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>single_point_crossover</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>parent1</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>                               <span class=n>parent2</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;单点交叉&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>child1</span> <span class=o>=</span> <span class=n>parent1</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>child2</span> <span class=o>=</span> <span class=n>parent2</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 随机选择交叉点</span>
</span></span><span class=line><span class=cl>        <span class=n>param_names</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>parent1</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>crossover_point</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>param_names</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 交换交叉点后的基因</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>crossover_point</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>param_names</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>param_name</span> <span class=o>=</span> <span class=n>param_names</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>child1</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>parent2</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>child2</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>parent1</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>child1</span><span class=p>,</span> <span class=n>child2</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>mutation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>population</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span> 
</span></span><span class=line><span class=cl>                <span class=n>param_bounds</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;变异操作&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>mutated_population</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>individual</span> <span class=ow>in</span> <span class=n>population</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mutated_individual</span> <span class=o>=</span> <span class=n>individual</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>param_name</span><span class=p>,</span> <span class=n>param_config</span> <span class=ow>in</span> <span class=n>param_bounds</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>mutation_rate</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 执行变异</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;int&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>mutated_individual</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                            <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                        <span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>elif</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;float&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>mutated_individual</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                            <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;bounds&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                        <span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>elif</span> <span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;choice&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>mutated_individual</span><span class=p>[</span><span class=n>param_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>param_config</span><span class=p>[</span><span class=s1>&#39;choices&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>mutated_population</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mutated_individual</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>mutated_population</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 过拟合检测与防范</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 过拟合检测方法</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;not-prose my-8 overflow-hidden rounded-lg bg-gray-900 shadow-lg&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p-4 overflow-x-auto&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;highlight&#34;</span><span class=o>&gt;&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;chroma&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>table</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lntable&#34;</span><span class=o>&gt;&lt;</span><span class=n>tr</span><span class=o>&gt;&lt;</span><span class=n>td</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lntd&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>pre</span> <span class=n>tabindex</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;chroma&#34;</span><span class=o>&gt;&lt;</span><span class=n>code</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>14</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>15</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>17</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>18</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>21</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>27</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>28</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>29</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>31</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>33</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>34</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>35</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>36</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>37</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>38</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>39</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>41</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>43</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>44</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>45</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>46</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>47</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>48</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>51</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>52</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>53</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>54</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>55</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>56</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>57</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>58</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>59</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>61</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>62</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>63</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>66</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>67</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>68</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>69</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>70</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>71</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>72</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>73</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>74</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>75</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>76</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>77</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>78</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>79</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>81</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>82</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>83</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>84</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>85</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>86</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>87</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>88</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>89</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>90</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>91</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>92</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>93</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>94</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>95</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>96</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>97</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>98</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>99</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>101</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>102</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>103</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>104</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>105</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>106</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>107</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>108</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>109</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>110</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>111</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>112</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>113</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>114</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>115</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>116</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>117</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>118</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>119</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>120</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>121</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>122</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>123</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>124</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>125</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>126</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>127</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>129</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>130</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>131</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>132</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>133</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>134</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>135</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>136</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>137</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>138</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>139</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>140</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>141</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>142</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>143</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>144</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>145</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>146</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>147</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>148</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>149</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>150</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>151</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>152</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>153</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>154</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>155</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>156</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>157</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>158</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>159</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>160</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>161</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>162</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>163</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>164</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>165</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>166</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>167</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>168</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>169</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>170</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>171</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>172</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>173</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>174</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>175</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>176</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>177</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>178</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>179</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>180</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>181</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>182</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>183</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>184</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>185</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>186</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>187</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>188</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>189</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>190</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>191</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>192</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>193</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>194</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>195</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>196</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>197</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>198</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>199</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>200</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>201</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>202</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>203</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>204</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>205</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>206</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>207</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>208</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>209</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>210</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>211</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>212</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>213</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>214</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>215</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>216</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>217</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>218</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>219</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>220</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>221</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>222</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>code</span><span class=o>&gt;&lt;/</span><span class=n>pre</span><span class=o>&gt;&lt;/</span><span class=n>td</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>td</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lntd&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>pre</span> <span class=n>tabindex</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;chroma&#34;</span><span class=o>&gt;&lt;</span><span class=n>code</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;language-python&#34;</span> <span class=n>data</span><span class=o>-</span><span class=n>lang</span><span class=o>=</span><span class=s2>&#34;python&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>class</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nc&#34;</span><span class=o>&gt;</span><span class=n>OverfittingDetector</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;过拟合检测器&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;fm&#34;</span><span class=o>&gt;</span><span class=fm>__init__</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>):</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>detection_results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>validation_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>walk_forward_analysis</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_class</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>param_grid</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>DataFrame</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>63</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>step_size</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>21</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;前向分析（Walk-Forward Analysis）&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>print</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;开始前向分析...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 获取所有交易日期&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get_trading_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>total_days</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 滑动窗口进行训练和测试&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>range</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>total_days</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>step_size</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>):</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 训练期&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_start</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_end</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 测试期&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_start</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_end</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>min</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_period</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>total_days</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>print</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;sa&#34;</span><span class=o>&gt;</span><span class=n>f</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;窗口 &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: 训练期 &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_start&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; - &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, &amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                  <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;sa&#34;</span><span class=o>&gt;</span><span class=n>f</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;测试期 &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_start&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; - &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_end&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 训练期数据&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get_period_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_start</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_end</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 测试期数据&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get_period_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_start</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_end</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 在训练期上优化参数&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>optimizer</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>ParameterOptimizer</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_class</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>BacktestConfig</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>optimization_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>optimizer</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>grid_search</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>param_grid</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>optimization_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;best_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 在测试期上验证&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>run_backtest_with_params</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>optimization_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;best_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test_data&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>({</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;train_period&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train_end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;test_period&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test_end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;best_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optimization_result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;best_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;train_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optimization_result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;best_performance&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;test_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test_result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;performance_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;performance_degradation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;calculate_performance_degradation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>optimization_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;best_performance&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;performance_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>})</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 分析结果&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>analysis</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>analyze_walk_forward_results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;walk_forward_results&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;analysis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;analysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_overfitted&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;analysis&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_overfitted&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>monte_carlo_permutation_test</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                                   <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>n_permutations</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1000</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;蒙特卡洛置换检验&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>print</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;sa&#34;</span><span class=o>&gt;</span><span class=n>f</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;开始蒙特卡洛置换检验（&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n_permutations&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;次置换）...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算原始夏普比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>original_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 生成随机置换&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>range</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>n_permutations</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>):</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 随机打乱收益率序列&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permutation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>values</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>index</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>index</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算置换后的夏普比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;%&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>100</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;==&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>print</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;sa&#34;</span><span class=o>&gt;</span><span class=n>f</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;  完成 &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n_permutations&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; 次置换&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>array</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算p值&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>p_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>permuted_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>original_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;original_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;original_sharpe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;mean_permuted_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;permuted_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;std_permuted_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;permuted_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;p_value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_significant&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p_value&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.05&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;n_permutations&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n_permutations&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>data_mining_bias_test</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_strategy_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;数据挖掘偏差检验&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>print</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;开始数据挖掘偏差检验...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算策略的夏普比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算随机策略的夏普比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_strategy_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>array</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算排名&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>random_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rank</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=nb>sum</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>percentile_rank</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rank</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>all_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;strategy_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strategy_sharpe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;mean_random_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;std_random_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rank&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rank&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;percentile_rank&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;percentile_rank&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_significant&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;percentile_rank&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;n_random_strategies&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_strategy_returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.03</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算夏普比率&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;==&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_performance_degradation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                                        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算性能衰减&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>degradation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>common_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>set</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>keys</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>())</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>amp</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>set</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>keys</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>())</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>metric</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>common_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>metric</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>get</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>metric</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;!=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>degradation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>metric</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>abs</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_value</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>degradation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>metric</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>degradation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>analyze_walk_forward_results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;分析前向分析结果&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>not</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 提取测试期指标&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>test_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>r</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;test_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sharpe_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>train_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>r</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;train_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sharpe_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算性能衰减&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>degradations</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>r</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;performance_degradation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sharpe_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>analysis</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;avg_test_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;std_test_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;avg_train_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;avg_degradation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;degradations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;min_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;max_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sharpe_consistency&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;abs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;test_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_overfitted&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;degradations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.3&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 平均衰减超过30%认为过拟合&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>analysis</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>get_trading_dates</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>DataFrame</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>datetime</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;获取交易日历&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>symbol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>list</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>keys</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>())[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>symbol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>index</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tolist</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>get_period_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>DataFrame</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                       <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_date</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>datetime</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end_date</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>datetime</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>DataFrame</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;获取指定期间的数据&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>symbol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>items</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>():</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mask</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>index</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_date</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>amp</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>index</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end_date</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>symbol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mask</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>run_backtest_with_params</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>params</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                                 <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>market_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>DataFrame</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;使用指定参数运行回测（简化实现）&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 这里应该创建策略实例并运行回测&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 为了简化，返回模拟结果&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;performance_metrics&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sharpe_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uniform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;2.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;total_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uniform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;max_drawdown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uniform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.05&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>code</span><span class=o>&gt;&lt;/</span><span class=n>pre</span><span class=o>&gt;&lt;/</span><span class=n>td</span><span class=o>&gt;&lt;/</span><span class=n>tr</span><span class=o>&gt;&lt;/</span><span class=n>table</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 性能评估指标</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 综合性能评估器</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;not-prose my-8 overflow-hidden rounded-lg bg-gray-900 shadow-lg&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p-4 overflow-x-auto&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;highlight&#34;</span><span class=o>&gt;&lt;</span><span class=n>div</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;chroma&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>table</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lntable&#34;</span><span class=o>&gt;&lt;</span><span class=n>tr</span><span class=o>&gt;&lt;</span><span class=n>td</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lntd&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>pre</span> <span class=n>tabindex</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;chroma&#34;</span><span class=o>&gt;&lt;</span><span class=n>code</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span>  <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>14</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>15</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>17</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>18</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>21</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>22</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>26</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>27</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>28</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>29</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>31</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>33</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>34</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>35</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>36</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>37</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>38</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>39</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>41</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>43</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>44</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>45</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>46</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>47</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>48</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>50</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>51</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>52</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>53</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>54</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>55</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>56</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>57</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>58</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>59</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>61</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>62</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>63</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>65</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>66</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>67</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>68</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>69</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>70</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>71</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>72</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>73</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>74</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>75</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>76</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>77</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>78</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>79</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>81</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>82</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>83</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>84</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>85</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>86</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>87</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>88</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>89</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>90</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>91</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>92</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>93</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>94</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>95</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>96</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>97</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>98</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span> <span class=mi>99</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>101</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>102</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>103</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>104</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>105</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>106</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>107</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>108</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>109</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>110</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>111</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>112</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>113</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>114</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>115</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>116</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>117</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>118</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>119</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>120</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>121</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>122</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>123</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>124</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>125</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>126</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>127</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>129</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>130</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>131</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>132</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>133</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>134</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>135</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>136</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>137</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>138</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>139</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>140</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>141</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>142</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>143</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>144</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>145</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>146</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>147</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>148</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>149</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>150</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>151</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>152</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>153</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>154</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>155</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>156</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>157</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>158</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>159</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>160</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>161</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>162</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>163</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>164</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>165</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>166</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>167</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>168</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>169</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>170</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>171</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>172</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>173</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>174</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>175</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>176</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>177</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>178</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>179</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>180</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>181</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>182</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>183</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>184</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>185</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>186</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>187</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>188</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>189</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>190</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>191</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>192</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>193</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>194</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>195</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>196</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>197</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>198</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>199</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>200</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>201</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>202</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>203</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>204</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>205</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>206</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>207</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>208</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>209</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>210</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>211</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>212</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>213</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>214</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>215</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>216</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>217</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>218</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>219</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>220</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>221</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>222</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>223</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>224</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>225</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>226</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>227</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>228</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>229</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>230</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>231</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>232</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>233</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>234</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>235</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>236</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>237</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>238</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>239</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>240</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>241</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>242</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>243</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>244</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>245</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>246</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>247</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>248</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>249</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>250</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>251</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>252</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>253</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>254</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>255</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>257</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>258</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>259</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>260</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>261</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>262</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>263</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>264</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>265</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>266</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>267</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>268</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>269</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>270</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>271</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>272</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>273</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>274</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>275</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>276</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>277</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>278</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>279</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>280</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>281</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>282</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>283</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>284</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>285</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>286</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>287</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>288</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>289</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>290</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>291</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>292</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>293</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>294</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>295</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>296</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>297</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>298</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>299</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>300</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>301</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>302</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>303</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>304</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>305</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>306</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>307</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>308</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>309</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>310</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>311</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>312</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>313</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>314</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>315</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>316</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>317</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>318</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>319</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>320</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>321</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>322</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>323</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>324</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>325</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>326</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>327</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>328</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>329</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>330</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>331</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>332</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>333</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>334</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>335</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>336</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>337</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>338</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>339</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>340</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>341</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>342</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>343</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>344</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>345</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>346</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>347</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>348</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>349</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>350</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>351</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>352</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>353</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>354</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>355</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lnt&#34;</span><span class=o>&gt;</span><span class=mi>356</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>code</span><span class=o>&gt;&lt;/</span><span class=n>pre</span><span class=o>&gt;&lt;/</span><span class=n>td</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>td</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;lntd&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>pre</span> <span class=n>tabindex</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;chroma&#34;</span><span class=o>&gt;&lt;</span><span class=n>code</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;language-python&#34;</span> <span class=n>data</span><span class=o>-</span><span class=n>lang</span><span class=o>=</span><span class=s2>&#34;python&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>class</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nc&#34;</span><span class=o>&gt;</span><span class=n>PerformanceEvaluator</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;性能评估器&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;fm&#34;</span><span class=o>&gt;</span><span class=fm>__init__</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.03</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>):</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation_results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>comprehensive_evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                               <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;综合性能评估&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 基本统计指标&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;basic_stats&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;calculate_basic_stats&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 风险调整指标&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;risk_adjusted&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;calculate_risk_adjusted_metrics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 回撤分析&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;drawdown_analysis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;analyze_drawdowns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 分布特征&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;distribution_stats&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;analyze_distribution&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 时间序列分析&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;time_series_stats&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;analyze_time_series&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 基准比较&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>is</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>not</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;benchmark_comparison&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compare_with_benchmark&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 稳定性分析&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;stability_analysis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;analyze_stability&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation_results</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>evaluation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_basic_stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算基本统计指标&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;total_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prod&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;annual_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;annual_volatility&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sqrt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;252&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;skewness&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;skew&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;kurtosis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kurtosis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;min_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;max_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;positive_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;negative_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;zero_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_risk_adjusted_metrics</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算风险调整指标&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>annual_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>annual_vol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 夏普比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>annual_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>annual_vol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>annual_vol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 索提诺比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>downside_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>downside_std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>downside_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>downside_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sortino_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>downside_std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>downside_std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>inf</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 卡尔马比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>max_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_max_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calmar_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>annual_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>abs</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>max_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>max_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;!=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>inf</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 信息比率（假设等权基准）&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>  <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 简化处理&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>active_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tracking_error</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>active_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>information_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>active_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tracking_error</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tracking_error</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sharpe_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sharpe_ratio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sortino_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sortino_ratio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;calmar_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calmar_ratio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;information_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;information_ratio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;excess_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;excess_return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;tracking_error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tracking_error&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>analyze_drawdowns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;分析回撤&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算累计收益&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumulative</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumprod</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算运行最大值&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>running_max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumulative</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>expanding</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=nb>max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算回撤&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumulative</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>running_max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>running_max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 最大回撤&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>max_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=nb>min</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 回撤持续时间&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>identify_drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 回撤恢复时间&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>recovery_times</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_recovery_times</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;max_drawdown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max_drawdown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;max_drawdown_duration&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;find_max_drawdown_duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drawdown_periods&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;avg_drawdown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;drawdown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drawdown&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drawdown&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;drawdown_volatility&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;drawdown&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;drawdown_periods&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drawdown_periods&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;avg_recovery_time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recovery_times&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;recovery_times&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;max_recovery_time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recovery_times&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;recovery_times&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;drawdown_series&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;drawdown&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>identify_drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Tuple</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;识别回撤期&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>in_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>False</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>enumerate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>):</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>and</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>not</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>in_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>in_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>True</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>elif</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>and</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>in_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>((</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>in_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>False</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 处理最后一个回撤期&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>in_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>((</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_recovery_times</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Tuple</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算恢复时间&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>recovery_times</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>recovery_time</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>recovery_times</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>recovery_time</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>recovery_times</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>find_max_drawdown_duration</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>List</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Tuple</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]])</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;找到最长回撤持续时间&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>not</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>durations</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>durations</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_max_drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算最大回撤&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumulative</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumprod</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>running_max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumulative</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>expanding</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=nb>max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cumulative</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>running_max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>running_max</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>drawdown</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=nb>min</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>analyze_distribution</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;分析收益分布&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 正态性检验&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>from</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nn&#34;</span><span class=o>&gt;</span><span class=n>scipy</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>import</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># Jarque-Bera检验&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>jb_stat</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>jb_pvalue</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>jarque_bera</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dropna</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>())</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># Shapiro-Wilk检验&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>5000</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>  <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># Shapiro-Wilk检验对样本大小有限制&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sw_stat</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sw_pvalue</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>shapiro</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dropna</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>())</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sw_stat</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sw_pvalue</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 分位数分析&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>quantiles</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.01</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.05</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.25</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.5</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.75</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.9</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.95</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.99</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>quantile_values</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>quantile</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>quantiles</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># VaR计算&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>var_95</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>quantile</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.05</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>var_99</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>quantile</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.01</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># CVaR计算&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cvar_95</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>var_95</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cvar_99</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>var_99</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;jb_statistic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jb_stat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;jb_pvalue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jb_pvalue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sw_statistic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sw_stat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sw_pvalue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sw_pvalue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_normal&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jb_pvalue&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.05&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;quantiles&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quantiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;quantile_values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;var_95&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;var_95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;var_99&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;var_99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;cvar_95&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cvar_95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;cvar_99&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cvar_99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;tail_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;abs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quantile_values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.05&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;abs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quantile_values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;quantile_values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.95&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inf&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>analyze_time_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;时间序列分析&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>from</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nn&#34;</span><span class=o>&gt;</span><span class=n>scipy</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>import</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 自相关检验&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>from</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nn&#34;</span><span class=o>&gt;</span><span class=n>statsmodels</span><span class=o>.</span><span class=n>stats</span><span class=o>.</span><span class=n>diagnostic</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>import</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>acorr_ljungbox</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>try</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># Ljung-Box检验（检验自相关）&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_test</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>acorr_ljungbox</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dropna</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(),</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lags</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>10</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>return_df</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>True</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_stat</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_test</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;lb_stat&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_pvalue</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_test</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;lb_pvalue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>except</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_stat</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lb_pvalue</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kc&#34;</span><span class=o>&gt;</span><span class=kc>None</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 单位根检验（ADF检验）&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>from</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nn&#34;</span><span class=o>&gt;</span><span class=n>statsmodels</span><span class=o>.</span><span class=n>tsa</span><span class=o>.</span><span class=n>stattools</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;kn&#34;</span><span class=o>&gt;</span><span class=n>import</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>adfuller</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>adf_result</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>adfuller</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dropna</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>())</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算滚动统计量&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_rolling_stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;lb_statistic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lb_stat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;lb_pvalue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lb_pvalue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;has_autocorrelation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lb_pvalue&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.05&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lb_pvalue&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;adf_statistic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adf_result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;adf_pvalue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adf_result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_stationary&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adf_result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.05&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rolling_stats&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rolling_stats&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_rolling_stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>window</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>60</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算滚动统计量&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rolling_mean&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rolling&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rolling_std&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rolling&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rolling_sharpe&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;calculate_rolling_sharpe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rolling_skewness&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rolling&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;skew&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;rolling_kurtosis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;returns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rolling&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kurt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_stats</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_rolling_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>window</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算滚动夏普比率&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>window</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>window</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_vol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>window</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>window</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>excess_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_vol</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>rolling_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>compare_with_benchmark</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> 
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                              <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;与基准比较&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 对齐数据&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>aligned_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>concat</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>([</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>axis</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>dropna</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>aligned_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>iloc</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[:,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>aligned_data</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>iloc</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[:,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算Alpha和Beta&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>covariance</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>cov</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_variance</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>var</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>beta</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>covariance</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_variance</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_variance</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_annual</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_annual</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>alpha</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_annual</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>beta</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_annual</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>risk_free_rate</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 跟踪误差&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tracking_error</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 信息比率&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>active_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>information_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>active_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tracking_error</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tracking_error</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 相关性&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>correlation</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>strategy_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>corr</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>benchmark_aligned</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;alpha&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;beta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;beta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;tracking_error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tracking_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;information_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;information_ratio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;correlation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;correlation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;active_return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;active_return&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>analyze_stability</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Dict</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>str</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Any</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;稳定性分析&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 分段时间分析&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>n_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>4</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_length</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;//&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>n_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>range</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>n_periods</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>):</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_length</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>min</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>((</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>i</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;+&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_length</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>iloc</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>start_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>end_idx</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_sharpe_ratio</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns_series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>()</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>252</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpe</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>                <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>append</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算稳定性指标&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sharpe_stability</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>abs</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_sharpes</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;!=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>inf</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>return_stability</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;/&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>abs</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>mean</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>period_returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;!=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>else</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>inf</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 计算Hurst指数（长期记忆性）&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>hurst_exponent</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>calculate_hurst_exponent</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>{</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;period_sharpes&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;period_sharpes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;period_returns&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;period_returns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;sharpe_stability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sharpe_stability&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;return_stability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;return_stability&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;hurst_exponent&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hurst_exponent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;has_long_memory&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hurst_exponent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s1&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#39;is_stable&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sharpe_stability&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;return_stability&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>}</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>    <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=n>def</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nf&#34;</span><span class=o>&gt;</span><span class=n>calculate_hurst_exponent</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;bp&#34;</span><span class=o>&gt;</span><span class=bp>self</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>pd</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>Series</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>max_lag</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>int</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>100</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&amp;</span><span class=n>gt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>float</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;s2&#34;</span><span class=o>&gt;&amp;</span><span class=c1>#34;&amp;#34;&amp;#34;计算Hurst指数&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lags</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>range</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>2</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>min</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>max_lag</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>,</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;//&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>4</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tau</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>sqrt</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>std</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>subtract</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lag</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:],</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>returns</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;-&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lag</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>])))</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>for</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lag</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;ow&#34;</span><span class=o>&gt;</span><span class=ow>in</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lags</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>if</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;nb&#34;</span><span class=o>&gt;</span><span class=nb>len</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tau</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;&amp;</span><span class=n>lt</span><span class=p>;</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>2</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>:</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>            <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>0.5</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;c1&#34;</span><span class=o>&gt;</span><span class=c1># 线性回归拟合&lt;/span&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>poly</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;=&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>polyfit</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>log</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>lags</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>),</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>np</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;.&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>log</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>tau</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>),</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>1</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>)</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;line&#34;</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;cl&#34;</span><span class=o>&gt;</span>        <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;k&#34;</span><span class=o>&gt;</span><span class=k>return</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;n&#34;</span><span class=o>&gt;</span><span class=n>poly</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>[</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mi&#34;</span><span class=o>&gt;</span><span class=mi>0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;p&#34;</span><span class=o>&gt;</span><span class=p>]</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;o&#34;</span><span class=o>&gt;*&lt;/</span><span class=n>span</span><span class=o>&gt;</span> <span class=o>&lt;</span><span class=n>span</span> <span class=n>class</span><span class=o>=</span><span class=s2>&#34;mf&#34;</span><span class=o>&gt;</span><span class=mf>2.0</span><span class=o>&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>span</span><span class=o>&gt;&lt;/</span><span class=n>code</span><span class=o>&gt;&lt;/</span><span class=n>pre</span><span class=o>&gt;&lt;/</span><span class=n>td</span><span class=o>&gt;&lt;/</span><span class=n>tr</span><span class=o>&gt;&lt;/</span><span class=n>table</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span></code></pre></td></tr></table></div></div></div></div></div></article><aside class="lg:w-80 xl:w-96"><div class=space-y-8></div></aside></div><nav class="border-t border-gray-200 mt-12 pt-8"><div class="flex justify-between items-center"><a href=/blog/%E6%8A%95%E8%B5%84%E7%90%86%E8%AE%BA/%E5%AE%8F%E8%A7%82%E5%88%86%E6%9E%90/09-%E6%94%BF%E6%B2%BB%E5%9B%A0%E7%B4%A0%E5%AF%B9%E8%82%A1%E5%B8%82%E7%9A%84%E5%BD%B1%E5%93%8D/ class="group flex items-center"><svg class="w-5 h-5 mr-2 text-gray-600 group-hover:text-primary-600" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0 7-7m-7 7h18"/></svg><div><div class="text-sm text-gray-600">上一篇</div><div class="font-medium group-hover:text-primary-600">宏观分析第9讲：政治因素对股市的影响</div></div></a><a href=/blog/content-management-hugo/ class="group flex items-center text-right"><div><div class="text-sm text-gray-600">Next Post</div><div class="font-medium group-hover:text-primary-600">敬请期待</div></div><svg class="w-5 h-5 ml-2 text-gray-600 group-hover:text-primary-600" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0-7 7m7-7H3"/></svg></a></div></nav></div></div><footer class="bg-gray-50 py-12 border-t border-gray-200"><div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl"><div class="flex flex-col md:flex-row justify-between space-y-4 md:space-y-0"><div class=flex-1><div class="flex items-center space-x-3 mb-4"><a href=https://sk-quant.github.io/ class=inline-block><img src=/images/logo.svg alt=烧烤量化 class=h-6>
</a><span class="text-xl font-bold text-gray-900">烧烤量化</span></div><div class="flex space-x-3 p-2"><a href=https://linkedin.com/in/yourusername class="text-gray-600 hover:text-gray-900" target=_blank rel="noopener noreferrer"><span class=sr-only>LinkedIn</span>
<img src=/images/social/linkedin.svg alt=LinkedIn class="h-5 w-5">
</a><a href=https://bsky.app/profile/yourblueskyhandle class="text-gray-600 hover:text-gray-900" target=_blank rel="noopener noreferrer"><span class=sr-only>Bluesky</span>
<img src=/images/social/bluesky.svg alt=Bluesky class="h-5 w-5">
</a><a href=https://twitter.com/yourusername class="text-gray-600 hover:text-gray-900" target=_blank rel="noopener noreferrer"><span class=sr-only>Twitter (X)</span>
<img src=/images/social/twitter.svg alt=Twitter class="h-5 w-5">
</a><a href=https://github.com/yourusername class="text-gray-600 hover:text-gray-900" target=_blank rel="noopener noreferrer"><span class=sr-only>GitHub</span>
<img src=/images/social/github.svg alt=GitHub class="h-5 w-5"></a></div></div><div class=flex-1><h3 class="text-sm font-semibold uppercase tracking-wider text-gray-900 mb-4"></h3><ul class=space-y-2></ul></div><div class=flex-1><h3 class="text-sm font-semibold uppercase tracking-wider text-gray-900 mb-4"></h3><ul class=space-y-2></ul></div><div class=flex-1><h3 class="text-sm font-semibold uppercase tracking-wider text-gray-900 mb-4"></h3><ul class=space-y-2></ul></div></div><div class="mt-12 pt-8 border-t border-gray-200"><div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0"><p class="text-gray-600 text-sm">© 2025 烧烤量化. All rights reserved.</p><a href=https://chaoming.li class="text-sm text-gray-600 hover:text-primary-600" target=_blank rel="noopener noreferrer">Powered by sk-quant</a></div></div></div></footer><script>const mobileMenuButton=document.getElementById("mobile-menu-button");mobileMenuButton&&mobileMenuButton.addEventListener("click",function(){const e=document.getElementById("mobile-menu");e&&e.classList.toggle("hidden")})</script></body></html>